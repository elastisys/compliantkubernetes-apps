# v0.48.0

Released 2025-07-29
<!-- -->
> [!IMPORTANT]
> **Platform Administrator Notice(s)**
> - Configuration of container images in Welkin has been reworked. Apart from any image updates implied by upgrading upstream charts, you should _at most_ see registries added to every image in the helmfile diff.
> - Fluentd-system namespace in wc is no longer backed up by velero. The only reason to possibly back up that namespace was to backup the fluentd aggregator PV. But it is very rarely going to be useful to restore that data, and there is a risk that restoring the data will actually make you lose more recent log data. Hence it was deemed to be best to not back up that PV.
> - It's now possible to change the services to be dual-stack globally.<br>You can also enforce this to all services by enabling the gatekeeper mutation.
<!-- -->
> [!NOTE]
> **Application Developer Notice(s)**
> - Grafana was upgraded to new major version 12, this comes some new features such as the ["Drilldown" page](https://grafana.com/blog/2025/02/20/grafana-drilldown-apps-the-improved-queryless-experience-formerly-known-as-the-explore-apps/). Please refer to the upstream release notes to see all [changes](https://grafana.com/docs/grafana/latest/whatsnew/whats-new-in-v12-0/).

## Release highlights

- An extensive (but most likely non-exhaustive) list of container images deployed by the applications stacks is now configurable under `helmfile.d/lists/images.yaml`.<br>The preferred format for a container image includes all of its parts: registry, repository, tag and digest. For example:<br>If the registry is omitted and a global registry is enabled via `images.global.registry.enabled = true` and `images.global.registry.uri = "example.com"`, then the global registry will be used instead.<br>The same logic holds for the "repository", which is the next `/`-delimited fragment after the registry.<br>For example, if an image in `images.yaml` is simply specified as `busybox:1.36` and both the global registry and repository are enabled, the final container URI will be: `global.registry/global-repository/busybox:1.36`.<br>If the image is specified with more than two `/`-delimited fragments, for example `elastisys/busybox:1.36`, then only the global registry will be taken into account, so the final image in this case would be `global.registry/elastisys/busybox:1.36`.

## Changes by kind

### Feature(s)

- [#2517](https://github.com/elastisys/compliantkubernetes-apps/pull/2517) - Add image signature verification Kyverno policy [@simonklb](https://github.com/simonklb)
- [#2536](https://github.com/elastisys/compliantkubernetes-apps/pull/2536) - Configurable images for all of the stacks [@rarescosma](https://github.com/rarescosma)
- [#2544](https://github.com/elastisys/compliantkubernetes-apps/pull/2544) - harbor-restore command added [@FredrikCarlssn](https://github.com/FredrikCarlssn)
- [#2566](https://github.com/elastisys/compliantkubernetes-apps/pull/2566) - Add Cluster Autoscaler alerts [@simonklb](https://github.com/simonklb)
- [#2573](https://github.com/elastisys/compliantkubernetes-apps/pull/2573) - Add cilium support for apps [@HaoruiPeng](https://github.com/HaoruiPeng)
- [#2591](https://github.com/elastisys/compliantkubernetes-apps/pull/2591) - Added dual-stack support [@Xartos](https://github.com/Xartos)
- [#2596](https://github.com/elastisys/compliantkubernetes-apps/pull/2596) - E2E: kubectl proxy access tests for prometheus & alertmanager [@rarescosma](https://github.com/rarescosma)
- [#2611](https://github.com/elastisys/compliantkubernetes-apps/pull/2611) - Add e2e test for Grafana user promotion [@rarescosma](https://github.com/rarescosma)

### Improvement(s)

- [#2556](https://github.com/elastisys/compliantkubernetes-apps/pull/2556) - Allow control-plane subnet in update-ips [@simonklb](https://github.com/simonklb)
- [#2564](https://github.com/elastisys/compliantkubernetes-apps/pull/2564) - apps wc: stop backing up fluentd-system namespace with velero in wc [@viktor-f](https://github.com/viktor-f)
- [#2565](https://github.com/elastisys/compliantkubernetes-apps/pull/2565) - apps-sc: upgrade harbor to app v2.13.1 and chart 1.17.1 [@viktor-f](https://github.com/viktor-f)
- [#2568](https://github.com/elastisys/compliantkubernetes-apps/pull/2568) - apps sc: S3 quota alerts per bucket [@Mlundm](https://github.com/Mlundm)
- [#2575](https://github.com/elastisys/compliantkubernetes-apps/pull/2575) - Support having apps repo as submodule in CK8S_CONFIG_PATH [@anders-elastisys](https://github.com/anders-elastisys)
- [#2576](https://github.com/elastisys/compliantkubernetes-apps/pull/2576) - Check Kubectl client version only to not prompt [@anders-elastisys](https://github.com/anders-elastisys)
- [#2581](https://github.com/elastisys/compliantkubernetes-apps/pull/2581) - Upgrade falco chart to v6.0.2 [@rarescosma](https://github.com/rarescosma)
- [#2583](https://github.com/elastisys/compliantkubernetes-apps/pull/2583) - Add vulnerability prevention to Harbor e2e testing [@elastisys-staffan](https://github.com/elastisys-staffan)
- [#2587](https://github.com/elastisys/compliantkubernetes-apps/pull/2587) - cilium: include internal cilium IPs in the update-ips flow [@rarescosma](https://github.com/rarescosma)
- [#2594](https://github.com/elastisys/compliantkubernetes-apps/pull/2594) - Pg/hnc tests [@Pavan-Gunda](https://github.com/Pavan-Gunda)
- [#2595](https://github.com/elastisys/compliantkubernetes-apps/pull/2595) - tests: update gatekeeper e2e [@Mlundm](https://github.com/Mlundm)
- [#2597](https://github.com/elastisys/compliantkubernetes-apps/pull/2597) - apps sc: increase trivy scanners memory [@linus-astrom](https://github.com/linus-astrom)
- [#2601](https://github.com/elastisys/compliantkubernetes-apps/pull/2601) - Upgrade Grafana chart to 9.2.10 [@anders-elastisys](https://github.com/anders-elastisys)
- [#2604](https://github.com/elastisys/compliantkubernetes-apps/pull/2604) - config: Change GPU containerd config overwrite path [@HaoruiPeng](https://github.com/HaoruiPeng)
- [#2606](https://github.com/elastisys/compliantkubernetes-apps/pull/2606) - apps: added rbac and opa policies for allowing ephemeral containers [@shafi-elastisys](https://github.com/shafi-elastisys)
- [#2612](https://github.com/elastisys/compliantkubernetes-apps/pull/2612) - feat: tell cypress to run in "headed" mode [@rarescosma](https://github.com/rarescosma)
- [#2616](https://github.com/elastisys/compliantkubernetes-apps/pull/2616) - bin: add error message for misconfigured swift config in update-ips [@anders-elastisys](https://github.com/anders-elastisys)
- [#2617](https://github.com/elastisys/compliantkubernetes-apps/pull/2617) - Cypress: type stubs for custom commands, QoL improvements and fat arrow fixes [@rarescosma](https://github.com/rarescosma)
- [#2619](https://github.com/elastisys/compliantkubernetes-apps/pull/2619) - Grafana tests love [@rarescosma](https://github.com/rarescosma)

### Other(s)

- [#2471](https://github.com/elastisys/compliantkubernetes-apps/pull/2471) - clean-up: Remove OpenSearch SLM [@lunkan93](https://github.com/lunkan93)
- [#2548](https://github.com/elastisys/compliantkubernetes-apps/pull/2548) - other: add kubernetes access tests [@Ajarmar](https://github.com/Ajarmar)
- [#2554](https://github.com/elastisys/compliantkubernetes-apps/pull/2554) - bug: config: Fixed missed optional config option from schema [@Xartos](https://github.com/Xartos)
- [#2555](https://github.com/elastisys/compliantkubernetes-apps/pull/2555) - other: Suppress kubectl output in update-ips [@simonklb](https://github.com/simonklb)
- [#2558](https://github.com/elastisys/compliantkubernetes-apps/pull/2558) - bug: Add Prometheus to Falco dependencies [@simonklb](https://github.com/simonklb)
- [#2559](https://github.com/elastisys/compliantkubernetes-apps/pull/2559) - other: bin: Changed sme-support email in diagnostics script [@AlbinB97](https://github.com/AlbinB97)
- [#2563](https://github.com/elastisys/compliantkubernetes-apps/pull/2563) - bug: Fix update-ips [@simonklb](https://github.com/simonklb)
- [#2569](https://github.com/elastisys/compliantkubernetes-apps/pull/2569) - bug: Fix cert-manager installation dependencies and improve deployment ordering [@FredrikCarlssn](https://github.com/FredrikCarlssn)
- [#2570](https://github.com/elastisys/compliantkubernetes-apps/pull/2570) - other: chore: bump kubectl version to 1.31.9 [@rarescosma](https://github.com/rarescosma)
- [#2571](https://github.com/elastisys/compliantkubernetes-apps/pull/2571) - bug: fix: kyverno setup needs some extra config to get going [@rarescosma](https://github.com/rarescosma)
- [#2572](https://github.com/elastisys/compliantkubernetes-apps/pull/2572) - other: Port 0.47.0 [@shafi-elastisys](https://github.com/shafi-elastisys)
- [#2574](https://github.com/elastisys/compliantkubernetes-apps/pull/2574) - bug: apps-wc: fix netpol for nginx to allow uptime ingress [@viktor-f](https://github.com/viktor-f)
- [#2579](https://github.com/elastisys/compliantkubernetes-apps/pull/2579) - bug: fix calls to set_/get_apps_version [@rarescosma](https://github.com/rarescosma)
- [#2580](https://github.com/elastisys/compliantkubernetes-apps/pull/2580) - bug: apps: alertmanager migration write to tmp [@shafi-elastisys](https://github.com/shafi-elastisys)
- [#2582](https://github.com/elastisys/compliantkubernetes-apps/pull/2582) - bug: apps: changed configserial addition [@shafi-elastisys](https://github.com/shafi-elastisys)
- [#2585](https://github.com/elastisys/compliantkubernetes-apps/pull/2585) - bug: Fredrikcarlssn/fixcalicoaccountant [@FredrikCarlssn](https://github.com/FredrikCarlssn)
- [#2586](https://github.com/elastisys/compliantkubernetes-apps/pull/2586) - bug: apps-sc: fix harbor image version in image list [@viktor-f](https://github.com/viktor-f)
- [#2600](https://github.com/elastisys/compliantkubernetes-apps/pull/2600) - bug: apps sc: migrate tekton image registry from gcr to ghcr [@lunkan93](https://github.com/lunkan93)
- [#2605](https://github.com/elastisys/compliantkubernetes-apps/pull/2605) - other: Configure "prettier" as a linter for .js test files [@rarescosma](https://github.com/rarescosma)
- [#2607](https://github.com/elastisys/compliantkubernetes-apps/pull/2607) - bug: fix: prettified too much [@rarescosma](https://github.com/rarescosma)
- [#2610](https://github.com/elastisys/compliantkubernetes-apps/pull/2610) - bug: Exclude rook-ceph namespace in pdb constraint policy [@anders-elastisys](https://github.com/anders-elastisys)
- [#2613](https://github.com/elastisys/compliantkubernetes-apps/pull/2613) - other: Port v0.46.1 [@HaoruiPeng](https://github.com/HaoruiPeng)
- [#2614](https://github.com/elastisys/compliantkubernetes-apps/pull/2614) - other: Port v0.47.1 [@HaoruiPeng](https://github.com/HaoruiPeng)
- [#2618](https://github.com/elastisys/compliantkubernetes-apps/pull/2618) - bug: apps sc: fix indexpernamespace for opensearch alerting role [@linus-astrom](https://github.com/linus-astrom)
- [#2625](https://github.com/elastisys/compliantkubernetes-apps/pull/2625) - other: chore: bump grafana image version to 12.0.3 [@rarescosma](https://github.com/rarescosma)
- [91b6510](https://github.com/elastisys/compliantkubernetes-apps/pull/2626/commits/91b6510ff5b4009d51fdd4d6bc0ba2eb5331e322) - fix: change to alertmanager api v2 in falcosidekick [@lunkan93](https://github.com/lunkan93)
- [5dfb63b](https://github.com/elastisys/compliantkubernetes-apps/pull/2626/commits/5dfb63ba4a04b3358690825080f6cc8f7ac7b662) -  fix: increase default grafana resources [@lunkan93](https://github.com/lunkan93)
