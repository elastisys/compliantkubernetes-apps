# file-copier

Chart for copying files to hosts

For now it only copies a json file (seccompprofile) from a ConfigMap to hosts where the ingress-nginx controller Pods run, if `ingressNginx.controller.chroot` = `true`.

## Maintaining the custom ingress-nginx chroot seccompprofile

The [ignress-nginx chroot seccompprofile](templates/ingress-nginx-chroot-cm.yaml) was generated by running the ingress-nginx controller container with the `RuntimeDefault` seccompprofile, `NET_BIND_SERVICE`, `SYS_CHROOT` & `SYS_ADMIN` capabilities. Note that you need to ease the PSPs when testing this.

Then inspect the container on the node `sudo crictl inspect <container id> | jq .info.runtimeSpec.linux.seccomp` and remove the unnecessary syscalls from the `SYS_ADMIN` capability. As of ingress-nginx `v1.8.4` only the `clone` and `unshare` syscalls were needed (from the `SYS_ADMIN` capability).
