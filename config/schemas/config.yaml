$schema: https://json-schema.org/draft/2020-12/schema
$id: https://github.com/elastisys/compliantkubernetes-apps/raw/main/config/schemas/config.yaml
title: Compliant Kubernetes Apps Config
description: |
  This describes the structure of the config for both the service and workload clusters.

  Keep in mind that this is evaluated on the merged config, and each config file will contain different properties.
$defs:
  component:
    deprecated: true
    additionalProperties: false
    description: This is meant to describe the base class if you will, for ck8s resources.
    properties:
      affinity:
        $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
      enabled:
        type: boolean
      nodeSelector:
        $ref: '#/$defs/kubernetesNodeSelector'
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
      topologySpreadConstraints:
        $ref: '#/$defs/kubernetesTopologySpreadConstraints'
    required: [] # Shouldn't at least 'enabled' be required?
    title: Common Resource
    type: object
  cpumem:
    deprecated: true
    description: |
      Use `.$defs.kubernetesQuantity` instead.
    additionalProperties: false
    properties:
      cpu:
        default: 100m
        pattern: ^[1-9][0-9]*m?$
        type:
          - string
          - integer
      memory:
        default: 128Mi
        pattern: ^[0-9]+(\.[0-9]+)?([KMG]i)?$
        type:
          - string
          - integer
    title: CPU and Memory specifications
    type: object
  extraArgs:
    items:
      type: string
    title: Extra arguments
    description: Extra arguments passed to a container
    type: array
  fluentdBuffer:
    additionalProperties:
      $comment: Assuming that these are never structures, only scalars
      not:
        type:
          - object
          - array
      type:
        - string
        - integer
        - boolean
    properties:
      chunkLimitSize:
        examples:
          - 50MB
        type: string
      flushInterval:
        examples:
          - 15m
        type: string
      flushMode:
        examples:
          - interval
        type: string
      flushThreadBurstInterval:
        type: number
      flushThreadCount:
        type: integer
      retryForever:
        type: boolean
      retryMaxInterval:
        type: integer
      retryType:
        examples:
          - exponential_backoff
        type: string
      timekey:
        examples:
          - 10m
        type: string
      timekeyUseUtc:
        type: boolean
      timekeyWait:
        examples:
          - 1m
        type: string
      totalLimitSize:
        examples:
          - 9GB
        type: string
    type: object
  goDuration:
    examples:
      - 2h45m0s
    pattern: ^([-+]?[0-9]+(.[0-9]+)?(ns|us|µs|ms|s|m|h))+$
    title: Duration string
    description: |
      A duration string is a possibly signed sequence of decimal numbers, each with optional fraction and a unit suffix, such as "300ms", "-1.5h" or "2h45m".
      Valid time units are "ns", "us" (or "µs"), "ms", "s", "m", "h".
    type: string
  iplist:
    title: List of IP netmasks
    items:
      type: string
      regex: ^[0-9a-f.:]{2,45}/[0-9]{1,3}$
      description: A IP address with netmask
      examples:
        - 0.0.0.0/0
        - 192.0.2.1/24
        - 2001:db8:0:1234::/64
    type: array
  netpolRule:
    title: IP and port list
    additionalProperties: false
    properties:
      ips:
        $ref: '#/$defs/iplist'
      ports:
        $ref: '#/$defs/portlist'
    type: object
  kubernetesNodeSelector:
    additionalProperties:
      type: string
    examples:
      - kubernetes.io/os: linux
    type: object
  percentage:
    description: Percentage, 0% - 100%
    maximum: 100
    minimum: 0
    title: Percentage
    type: number
  portlist:
    title: Port number
    description: A 16 bit unsigned integer
    items:
      maximum: 65535
      minimum: 1
      type: integer
    type: array
  kubernetesResourceRequirements:
    title: Resource requirements
    description: |-
      Resource requests are used by the kube-scheduler to pick a node to schedule
      pods on. Limits are enforced. Resources are commonly 'cpu' and 'memory'.
    additionalProperties: false
    properties:
      requests:
        $ref: '#/$defs/kubernetesQuantityMap'
      limits:
        $ref: '#/$defs/kubernetesQuantityMap'
    type: object
    examples:
      - requests:
          memory: 128Mi
          cpu: 100m
        limits:
          memory: 256Mi
          cpu: 250m
  timeRange:
    examples:
      - 300s
      - 72h
      - 3d
    pattern: ^[0-9]+[hmsd]+$
    title: An amount of time
    type: string
  kubernetesTolerations:
    items:
      additionalProperties: false
      properties:
        effect:
          examples:
            - NoExecute
            - NoSchedule
            - PreferNoSchedule
          type: string
        key:
          examples:
            - node.kubernetes.io/memory-pressure
            - node.kubernetes.io/not-ready
            - node.kubernetes.io/unreachable
            - node-role.kubernetes.io/control-plane
            - node-role.kubernetes.io/master
          type: string
        operator:
          examples:
            - Exists
          type: string
        tolerationSeconds:
          type: integer
        value:
          type: string
      type: object
    type: array
  kubernetesTopologySpreadConstraints:
    items:
      additionalProperties: false
      properties:
        labelSelector:
          additionalProperties: false
          properties:
            matchLabels:
              additionalProperties:
                type: string
              properties: {}
              type: object
          type: object
        maxSkew:
          default: 1
          type: number
        topologyKey:
          default: kubernetes.io/hostname
          type: string
        whenUnsatisfiable:
          default: DoNotSchedule
          type: string
      type: object
    type: array
  kubernetesQuantityMap:
    type: object
    additionalProperties:
      $ref: '#/$defs/kubernetesQuantity'
  kubernetesQuantity:
    title: Quantity
    type:
      - string
      - number
    regex: ^[-+]?[0-9]+([KMGTPE]i|[eE][0-9]+|[mkMGTPE])?$
    description: |-
      Used for CPU shares, memory and storage size etc.

      See <https://github.com/kubernetes/apimachinery/blob/master/pkg/api/resource/quantity.go>
  io.k8s.api.core.v1.Affinity:
    description: Affinity is a group of affinity scheduling rules.
    properties:
      nodeAffinity:
        allOf:
          - $ref: '#/$defs/io.k8s.api.core.v1.NodeAffinity'
        description: Describes node affinity scheduling rules for the pod.
      podAffinity:
        allOf:
          - $ref: '#/$defs/io.k8s.api.core.v1.PodAffinity'
        description: Describes pod affinity scheduling rules (e.g. co-locate this pod in the same node, zone, etc. as some other pod(s)).
      podAntiAffinity:
        allOf:
          - $ref: '#/$defs/io.k8s.api.core.v1.PodAntiAffinity'
        description: Describes pod anti-affinity scheduling rules (e.g. avoid putting this pod in the same node, zone, etc. as some other pod(s)).
    type: object
  io.k8s.apimachinery.pkg.apis.meta.v1.LabelSelectorRequirement:
    description: A label selector requirement is a selector that contains values, a key, and an operator that relates the key and values.
    properties:
      key:
        default: ""
        description: key is the label key that the selector applies to.
        type: string
      operator:
        default: ""
        description: operator represents a key's relationship to a set of values. Valid operators are In, NotIn, Exists and DoesNotExist.
        type: string
      values:
        description: values is an array of string values. If the operator is In or NotIn, the values array must be non-empty. If the operator is Exists or DoesNotExist, the values array must be empty. This array is replaced during a strategic merge patch.
        items:
          default: ""
          type: string
        type: array
        x-kubernetes-list-type: atomic
    required:
      - key
      - operator
    type: object
  io.k8s.api.core.v1.NodeAffinity:
    description: Node affinity is a group of node affinity scheduling rules.
    properties:
      preferredDuringSchedulingIgnoredDuringExecution:
        description: The scheduler will prefer to schedule pods to nodes that satisfy the affinity expressions specified by this field, but it may choose a node that violates one or more of the expressions. The node that is most preferred is the one with the greatest sum of weights, i.e. for each node that meets all of the scheduling requirements (resource request, requiredDuringScheduling affinity expressions, etc.), compute a sum by iterating through the elements of this field and adding "weight" to the sum if the node matches the corresponding matchExpressions; the node(s) with the highest sum are the most preferred.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.PreferredSchedulingTerm'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
      requiredDuringSchedulingIgnoredDuringExecution:
        allOf:
          - $ref: '#/$defs/io.k8s.api.core.v1.NodeSelector'
        description: If the affinity requirements specified by this field are not met at scheduling time, the pod will not be scheduled onto the node. If the affinity requirements specified by this field cease to be met at some point during pod execution (e.g. due to an update), the system may or may not try to eventually evict the pod from its node.
    type: object
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.PodAffinity:
    description: Pod affinity is a group of inter pod affinity scheduling rules.
    properties:
      preferredDuringSchedulingIgnoredDuringExecution:
        description: The scheduler will prefer to schedule pods to nodes that satisfy the affinity expressions specified by this field, but it may choose a node that violates one or more of the expressions. The node that is most preferred is the one with the greatest sum of weights, i.e. for each node that meets all of the scheduling requirements (resource request, requiredDuringScheduling affinity expressions, etc.), compute a sum by iterating through the elements of this field and adding "weight" to the sum if the node has pods which matches the corresponding podAffinityTerm; the node(s) with the highest sum are the most preferred.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.WeightedPodAffinityTerm'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
      requiredDuringSchedulingIgnoredDuringExecution:
        description: If the affinity requirements specified by this field are not met at scheduling time, the pod will not be scheduled onto the node. If the affinity requirements specified by this field cease to be met at some point during pod execution (e.g. due to a pod label update), the system may or may not try to eventually evict the pod from its node. When there are multiple elements, the lists of nodes corresponding to each podAffinityTerm are intersected, i.e. all terms must be satisfied.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.PodAffinityTerm'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
    type: object
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.PodAntiAffinity:
    description: Pod anti affinity is a group of inter pod anti affinity scheduling rules.
    properties:
      preferredDuringSchedulingIgnoredDuringExecution:
        description: The scheduler will prefer to schedule pods to nodes that satisfy the anti-affinity expressions specified by this field, but it may choose a node that violates one or more of the expressions. The node that is most preferred is the one with the greatest sum of weights, i.e. for each node that meets all of the scheduling requirements (resource request, requiredDuringScheduling anti-affinity expressions, etc.), compute a sum by iterating through the elements of this field and adding "weight" to the sum if the node has pods which matches the corresponding podAffinityTerm; the node(s) with the highest sum are the most preferred.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.WeightedPodAffinityTerm'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
      requiredDuringSchedulingIgnoredDuringExecution:
        description: If the anti-affinity requirements specified by this field are not met at scheduling time, the pod will not be scheduled onto the node. If the anti-affinity requirements specified by this field cease to be met at some point during pod execution (e.g. due to a pod label update), the system may or may not try to eventually evict the pod from its node. When there are multiple elements, the lists of nodes corresponding to each podAffinityTerm are intersected, i.e. all terms must be satisfied.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.PodAffinityTerm'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
    type: object
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.PreferredSchedulingTerm:
    description: An empty preferred scheduling term matches all objects with implicit weight 0 (i.e. it's a no-op). A null preferred scheduling term matches no objects (i.e. is also a no-op).
    properties:
      preference:
        allOf:
          - $ref: '#/$defs/io.k8s.api.core.v1.NodeSelectorTerm'
        default: {}
        description: A node selector term, associated with the corresponding weight.
      weight:
        default: 0
        description: Weight associated with matching the corresponding nodeSelectorTerm, in the range 1-100.
        format: int32
        type: integer
    required:
      - weight
      - preference
    type: object
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.NodeSelector:
    description: A node selector represents the union of the results of one or more label queries over a set of nodes; that is, it represents the OR of the selectors represented by the node selector terms.
    properties:
      nodeSelectorTerms:
        description: Required. A list of node selector terms. The terms are ORed.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.NodeSelectorTerm'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
    required:
      - nodeSelectorTerms
    type: object
    x-kubernetes-map-type: atomic
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.WeightedPodAffinityTerm:
    description: The weights of all of the matched WeightedPodAffinityTerm fields are added per-node to find the most preferred node(s)
    properties:
      podAffinityTerm:
        allOf:
          - $ref: '#/$defs/io.k8s.api.core.v1.PodAffinityTerm'
        default: {}
        description: Required. A pod affinity term, associated with the corresponding weight.
      weight:
        default: 0
        description: weight associated with matching the corresponding podAffinityTerm, in the range 1-100.
        format: int32
        type: integer
    required:
      - weight
      - podAffinityTerm
    type: object
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.PodAffinityTerm:
    description: Defines a set of pods (namely those matching the labelSelector relative to the given namespace(s)) that this pod should be co-located (affinity) or not co-located (anti-affinity) with, where co-located is defined as running on a node whose value of the label with key <topologyKey> matches that of any node on which a pod of the set of pods is running
    properties:
      labelSelector:
        allOf:
          - $ref: '#/$defs/io.k8s.apimachinery.pkg.apis.meta.v1.LabelSelector'
        description: A label query over a set of resources, in this case pods. If it's null, this PodAffinityTerm matches with no Pods.
      matchLabelKeys:
        description: MatchLabelKeys is a set of pod label keys to select which pods will be taken into consideration. The keys are used to lookup values from the incoming pod labels, those key-value labels are merged with `labelSelector` as `key in (value)` to select the group of existing pods which pods will be taken into consideration for the incoming pod's pod (anti) affinity. Keys that don't exist in the incoming pod labels will be ignored. The default value is empty. The same key is forbidden to exist in both matchLabelKeys and labelSelector. Also, matchLabelKeys cannot be set when labelSelector isn't set. This is an alpha field and requires enabling MatchLabelKeysInPodAffinity feature gate.
        items:
          default: ""
          type: string
        type: array
        x-kubernetes-list-type: atomic
      mismatchLabelKeys:
        description: MismatchLabelKeys is a set of pod label keys to select which pods will be taken into consideration. The keys are used to lookup values from the incoming pod labels, those key-value labels are merged with `labelSelector` as `key notin (value)` to select the group of existing pods which pods will be taken into consideration for the incoming pod's pod (anti) affinity. Keys that don't exist in the incoming pod labels will be ignored. The default value is empty. The same key is forbidden to exist in both mismatchLabelKeys and labelSelector. Also, mismatchLabelKeys cannot be set when labelSelector isn't set. This is an alpha field and requires enabling MatchLabelKeysInPodAffinity feature gate.
        items:
          default: ""
          type: string
        type: array
        x-kubernetes-list-type: atomic
      namespaceSelector:
        allOf:
          - $ref: '#/$defs/io.k8s.apimachinery.pkg.apis.meta.v1.LabelSelector'
        description: A label query over the set of namespaces that the term applies to. The term is applied to the union of the namespaces selected by this field and the ones listed in the namespaces field. null selector and null or empty namespaces list means "this pod's namespace". An empty selector ({}) matches all namespaces.
      namespaces:
        description: namespaces specifies a static list of namespace names that the term applies to. The term is applied to the union of the namespaces listed in this field and the ones selected by namespaceSelector. null or empty namespaces list and null namespaceSelector means "this pod's namespace".
        items:
          default: ""
          type: string
        type: array
        x-kubernetes-list-type: atomic
      topologyKey:
        default: ""
        description: This pod should be co-located (affinity) or not co-located (anti-affinity) with the pods matching the labelSelector in the specified namespaces, where co-located is defined as running on a node whose value of the label with key topologyKey matches that of any node on which any of the selected pods is running. Empty topologyKey is not allowed.
        type: string
    required:
      - topologyKey
    type: object
    $comment: Imported from Kubernetes project
  io.k8s.apimachinery.pkg.apis.meta.v1.LabelSelector:
    description: A label selector is a label query over a set of resources. The result of matchLabels and matchExpressions are ANDed. An empty label selector matches all objects. A null label selector matches no objects.
    properties:
      matchExpressions:
        description: matchExpressions is a list of label selector requirements. The requirements are ANDed.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.apimachinery.pkg.apis.meta.v1.LabelSelectorRequirement'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
      matchLabels:
        additionalProperties:
          default: ""
          type: string
        description: matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels map is equivalent to an element of matchExpressions, whose key field is "key", the operator is "In", and the values array contains only "value". The requirements are ANDed.
        type: object
    type: object
    x-kubernetes-map-type: atomic
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.NodeSelectorTerm:
    description: A null or empty node selector term matches no objects. The requirements of them are ANDed. The TopologySelectorTerm type implements a subset of the NodeSelectorTerm.
    properties:
      matchExpressions:
        description: A list of node selector requirements by node's labels.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.NodeSelectorRequirement'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
      matchFields:
        description: A list of node selector requirements by node's fields.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.NodeSelectorRequirement'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
    type: object
    x-kubernetes-map-type: atomic
  io.k8s.api.core.v1.NodeSelectorRequirement:
    description: A node selector requirement is a selector that contains values, a key, and an operator that relates the key and values.
    properties:
      key:
        default: ""
        description: The label key that the selector applies to.
        type: string
      operator:
        default: ""
        description: Represents a key's relationship to a set of values. Valid operators are In, NotIn, Exists, DoesNotExist. Gt, and Lt.
        type: string
      values:
        description: An array of string values. If the operator is In or NotIn, the values array must be non-empty. If the operator is Exists or DoesNotExist, the values array must be empty. If the operator is Gt or Lt, the values array must have a single element, which will be interpreted as an integer. This array is replaced during a strategic merge patch.
        items:
          default: ""
          type: string
        type: array
        x-kubernetes-list-type: atomic
    required:
      - key
      - operator
    type: object
    $comment: Imported from Kubernetes project
type: object
required:
  - global
properties:
  global:
    title: Global options
    description: Some common options used in various helm charts.
    type: object
    required:
      - ck8sVersion
      - ck8sCloudProvider
      - ck8sEnvironmentName
      - ck8sFlavor
      - baseDomain
      - opsDomain
    properties:
      ck8sVersion:
        title: Compliant Kubernetes Apps version
        description: |-
          Use version number if you are exactly at a release tag.
          Otherwise use full commit hash of current commit.
          `any`, can be used to disable this validation.
        type: string
        examples:
          - v0.42.1
          - any
          - 424442541a567646c232d949bad1af2b5b7cb885
      ck8sCloudProvider:
        type: string
        enum:
          - aws
          - azure
          - baremetal
          - citycloud
          - elastx
          - exoscale
          - none
          - safespring
          - upcloud
      ck8sEnvironmentName:
        title: Environment name
        type: string
        examples:
          - my-ck8s-cluster
      ck8sFlavor:
        type: string
        enum:
          - prod
          - dev
          - air-gapped
      baseDomain:
        title: Base Domain
        description: |-
          Domain intended for ingress usage in the workload cluster
          and to reach application developer facing services such as Grafana, Harbor and OpenSearch Dashboards.
          E.g. with 'prod.domain.com', OpenSearch Dashboards is reached via 'opensearch.prod.domain.com'.
        type: string
        format: hostname
      opsDomain:
        description: |-
          Domain intended for ingress usage in the service cluster and to reach
          non-user facing services such as Thanos and OpenSearch.
          E.g. with 'ops.prod.domain.com', OpenSearch is reached via 'opensearch.ops.prod.domain.com'.
        type: string
        format: hostname
      scDomain:
        description: If baseDomain for wc and sc are not the same, set the domain of the sc cluster.
        type: string
        oneOf: # Templates do not handle missing values so they must be empty strings to disable. Future FIXME?
          - const: ""
          - format: hostname
      scOpsDomain:
        description: If opsDomain for wc and sc are not the same, set the ops domain of the sc cluster.
        type: string
        oneOf:
          - const: ""
          - format: hostname
      issuer:
        description: |-
          Default cert-manager issuer to use for issuing certificates for ingresses.
          Normally one of `letsencrypt-staging` or `letsencrypt-prod`.
        type: string
        default: letsencrypt-staging
        enum:
          - letsencrypt-staging
          - letsencrypt-prod
      verifyTls:
        description: Verify ingress certificates
        type: boolean
        default: true
      clusterDns:
        description: IP of the cluster DNS in kubernetes
        type: string
        default: 10.233.0.3
        format: ip-address
      clusterName:
        type: string
      clustersMonitoring:
        description: |-
          Names of the workload clusters that sends metrics to this cluster.
          Mainly used for filtering of metrics.
        type: array
        items:
          type: string
          pattern: -[sw]c$
      containerRuntime:
        title: Container runtime
        default: containerd
        type: string
        enum:
          - containerd
          - docker
    additionalProperties: false
  clusterApi:
    additionalProperties: false
    properties:
      clusters:
        items:
          type: string
        type: array
      enabled:
        default: false
        type: boolean
      monitoring:
        additionalProperties: false
        properties:
          enabled:
            default: false
            type: boolean
        type: object
    type: object
  user:
    additionalProperties: false
    properties:
      adminGroups:
        items:
          type: string
        type: array
      adminUsers:
        items:
          examples:
            - admin@example.com
          type: string
        type: array
      constraints:
        additionalProperties:
          additionalProperties:
            properties: {}
            type: object
          properties: {}
          propertyNames:
            title: Service name
            type: string
          type: object
        description: |-
          Any namespace listed in constraints are exempted from HNC managed namespaces
          This to override the Pod Security Admission level
          Example of constraint can be found here: helmfile.d/charts/gatekeeper/podsecuritypolicies/values.yaml
          The only extra label "psaLevel: <baseline/privileged>" is shown in the following example:
          <namespace>:
            psaLevel: <baseline/privileged>
            <service-name>:
              ...
        properties: {}
        propertyNames:
          title: Namespace
          type: string
        type: object
      createNamespaces:
        type: boolean
        description: This only controls if the namespaces should be created, user RBAC is always created.
      grafanaPassword:
        type: string
      namespaces:
        items:
          examples:
            - production
            - staging
          type: string
        type: array
      serviceAccounts:
        items:
          type: string
        type: array
      alertmanager:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          enabled:
            type: boolean
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
          topologySpreadConstraints:
            $ref: '#/$defs/kubernetesTopologySpreadConstraints'
          ingress:
            type: object
            properties:
              enabled:
                type: boolean
          image:
            type: string
            examples:
              - quay.io/prometheus/alertmanager:vX.Y.Z
            description: Set to override the alertmanager container image
        type: object
      sealedSecrets:
        type: object
        properties:
          enabled:
            type: boolean
        additionalProperties: false
        title: sealedSecrets
        description: |-
          Installs required cluster resources needed to install sealedSecrets
          Requires that gatekeeper.allowUserCRDs.enabled is enabled.
      mongodb:
        description: |-
          Installs required cluster resources needed to install fluxv2
          Requires that gatekeeper.allowUserCRDs.enabled is enabled.
        type: object
        properties:
          enabled:
            type: boolean
        additionalProperties: false
        title: mongodb
      fluxv2:
        type: object
        properties:
          enabled:
            type: boolean
        additionalProperties: false
        title: fluxv2
        description: |-
          Installs required cluster resources needed to install fluxv2
          Requires that gatekeeper.allowUserCRDs.enabled is enabled.
      kafka:
        description: |-
          Installs required cluster resources needed to install kafka-operator
          Requires that gatekeeper.allowUserCRDs.enabled is enabled.
        type: object
        properties:
          enabled:
            type: boolean
        additionalProperties: false
        title: kafka
    type: object
    title: User configuration
  hnc:
    additionalProperties: false
    properties:
      additionalAllowPropagateResources:
        items:
          additionalProperties: false
          properties:
            group:
              examples:
                - networking.k8s.io
              type: string
            resource:
              examples:
                - networkpolicies
                - secrets
              type: string
          type: object
        type: array
      excludedExtraNamespaces:
        items:
          type: string
        type: array
      excludedNamespaces:
        items:
          examples:
            - alertmanager
            - cert-manager
            - falco
            - fluentd
            - fluentd-system
            - gatekeeper-system
            - hnc-system
            - ingress-nginx
            - kube-node-lease
            - kube-public
            - kube-system
            - kured
            - metallb-system
            - monitoring
            - rook-ceph
            - velero
          type: string
        type: array
      ha:
        type: boolean
      includedNamespacesRegex:
        type: string
      managedNamespaceAnnotations:
        items:
          type: string
        type: array
      managedNamespaceLabels:
        items:
          examples:
            - pod-security.kubernetes.io/audit
            - pod-security.kubernetes.io/enforce
            - pod-security.kubernetes.io/warn
          type: string
        type: array
      manager:
        $ref: '#/$defs/component'
      serviceMonitor:
        additionalProperties: false
        properties:
          relabelings:
            items: {}
            type: array
        type: object
      unpropagatedAnnotations:
        items: {}
        type: array
      webhook:
        additionalProperties: false
        properties:
          affinity:
            additionalProperties: false
            properties: {}
            type: object
          nodeSelector:
            additionalProperties: false
            properties: {}
            type: object
          replicaCount:
            type: integer
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          tolerations:
            items: {}
            type: array
          topologySpreadConstraints:
            items:
              additionalProperties: false
              properties:
                labelSelector:
                  additionalProperties: false
                  properties:
                    matchLabels:
                      additionalProperties: false
                      properties:
                        app.kubernetes.io/component:
                          examples:
                            - hnc-webhook
                          type: string
                      type: object
                  type: object
                maxSkew:
                  type: integer
                topologyKey:
                  examples:
                    - kubernetes.io/hostname
                  type: string
                whenUnsatisfiable:
                  examples:
                    - DoNotSchedule
                  type: string
              type: object
            type: array
        type: object
      webhookMatchConditions:
        type: boolean
      enabled:
        type: boolean
    type: object
  harbor:
    additionalProperties: false
    properties:
      alerts:
        additionalProperties: false
        properties:
          maxTotalArtifacts:
            default: 1000
            type: number
          maxTotalStorageUsedGB:
            default: 500
            type: number
        type: object
      backup:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          ephemeralBackupStore:
            properties:
              enabled:
                type: boolean
              storageSize:
                type: string
            type: object
          retentionDays:
            default: 7
            type: number
        type: object
      core:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          replicas:
            default: 1
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      database:
        additionalProperties: false
        properties:
          external:
            additionalProperties: false
            properties:
              coreDatabase:
                default: registry
                type: string
              notaryServerDatabase:
                default: notaryserver
                type: string
              notarySignerDatabase:
                default: notarysigner
                type: string
              port:
                default: "5432"
                type: string
              sslmode:
                default: disable
                enum:
                  - disable
                  - require
                  - verify-ca
                  - verify-full
                type: string
            type: object
          internal:
            additionalProperties: false
            properties:
              affinity:
                $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
              persistentVolumeClaim:
                additionalProperties: false
                properties:
                  size:
                    default: 1Gi
                    type: string
                type: object
              resources:
                $ref: '#/$defs/kubernetesResourceRequirements'
            type: object
          type:
            default: internal
            type: string
        type: object
      enabled:
        default: true
        type: boolean
      gc:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          forceConfigure:
            default: false
            type: boolean
          schedule:
            default: 0 0 0 * * SUN
            type: string
        type: object
      ingress:
        additionalProperties: false
        properties:
          additionalAnnotations:
            type: object
          defaultAnnotations:
            additionalProperties: false
            properties:
              nginx.ingress.kubernetes.io/proxy-buffering:
                default: off
                type: string
              nginx.ingress.kubernetes.io/proxy-request-buffering:
                default: off
                type: string
            type: object
        type: object
      jobservice:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          jobLog:
            additionalProperties: false
            properties:
              persistentVolumeClaim:
                additionalProperties: false
                properties:
                  size:
                    default: 1Gi
                    type: string
                type: object
            type: object
          jobLoggers:
            items:
              default: file
              type: string
            type: array
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          scanDataExports:
            additionalProperties: false
            properties:
              persistentVolumeClaim:
                additionalProperties: false
                properties:
                  size:
                    default: 1Gi
                    type: string
                type: object
            type: object
        type: object
      nodeSelector:
        $ref: '#/$defs/kubernetesNodeSelector'
      notary:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          replicas:
            default: 1
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          subdomain:
            default: notary.harbor
            type: string
        type: object
      notarySigner:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      oidc:
        additionalProperties: false
        properties:
          adminGroupName:
            type: string
          groupClaimName:
            default: groups
            type: string
          scope:
            default: openid,email,profile,offline_access,groups
            type: string
        type: object
      persistence:
        additionalProperties: false
        properties:
          disableRedirect:
            type: boolean
          type:
            type: string
        type: object
      portal:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          replicas:
            default: 1
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      redis:
        additionalProperties: false
        properties:
          external:
            additionalProperties: false
            properties:
              addr:
                examples:
                  - rfs-redis-harbor.redis-system.svc.cluster.local:26379
                type: string
              sentinelMasterSet:
                type: string
            type: object
          internal:
            additionalProperties: false
            properties:
              affinity:
                $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
              persistentVolumeClaim:
                additionalProperties: false
                properties:
                  size:
                    default: 1Gi
                    type: string
                type: object
              resources:
                $ref: '#/$defs/kubernetesResourceRequirements'
            type: object
          type:
            default: internal
            type: string
        type: object
      registry:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          controller:
            additionalProperties: false
            properties:
              resources:
                $ref: '#/$defs/kubernetesResourceRequirements'
            type: object
          persistentVolumeClaim:
            additionalProperties: false
            properties:
              size:
                default: 5Gi
                type: string
            type: object
          replicas:
            default: 1
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      s3:
        additionalProperties: false
        properties:
          multipartcopythresholdsize:
            default: "536870912"
            type: string
            $comment: turn into number?
          multipartcopychunksize:
            type:
              - integer
              - string
          multipartcopymaxconcurrency:
            type:
              - integer
              - string
        type: object
      subdomain:
        default: harbor
        type: string
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
      trivy:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          persistentVolumeClaim:
            additionalProperties: false
            properties:
              size:
                default: 5Gi
                type: string
            type: object
          replicas:
            default: 1
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      exporter:
        additionalProperties: false
        properties:
          external:
            additionalProperties: false
            properties:
              coreDatabase:
                examples:
                  - registry
                type: string
              port:
                examples:
                  - "5432"
                type: string
            type: object
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
    type: object
  storageClasses:
    additionalProperties: false
    properties:
      default:
        type: string
    type: object
  objectStorage:
    additionalProperties: false
    description: Swift can be enabled separately for Harbor, Thanos and rclone-sync only.
    properties:
      buckets:
        additionalProperties:
          type: string
        description: Buckets where each respective application will store its backups.
        type: object
      s3:
        additionalProperties: false
        properties:
          accessKey:
            type: string
          forcePathStyle:
            description: Generally false when using AWS and Exoscale and true for other providers.
            type: boolean
          region:
            type: string
          regionEndpoint:
            description: S3 endpoint for non-AWS implementation of S3. Make sure to prepend the protocol (i.e., https:// or http://) with the URL, e.g., https://s3.sto1.safedc.net
            type: string
          secretKey:
            type: string
        type: object
      sync:
        additionalProperties: false
        properties:
          buckets:
            type: array
          defaultSchedule:
            default: 0 5 * * *
            type: string
          destinationType:
            default: s3
            type: string
          enabled:
            default: false
            type: boolean
          encrypt:
            additionalProperties: false
            properties:
              directoryNames:
                default: false
                type: boolean
              enabled:
                default: false
                type: boolean
              fileNames:
                default: false
                type: boolean
            type: object
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          s3:
            $ref: '#/properties/objectStorage/properties/s3'
          syncDefaultBuckets:
            default: false
            type: boolean
        type: object
      type:
        enum:
          - s3
          - gcs
          - none
        type: string
      swift:
        type: object
        properties:
          authVersion:
            type: number
          authUrl:
            type: string
            format: uri
          region:
            type: string
          domainId:
            type: string
          domainName:
            type: string
            format: hostname
          projectDomainId:
            type: string
          projectDomainName:
            type: string
            format: hostname
          projectId:
            type: string
          projectName:
            type: string
          segmentsContainerSuffix:
            type: string
      restore:
        type: object
        properties: {}
        $comment: TODO
    type: object
  rookCeph:
    additionalProperties: false
    properties:
      gatekeeperPsp:
        additionalProperties: false
        properties:
          enabled:
            default: false
            type: boolean
        type: object
      monitoring:
        additionalProperties: false
        properties:
          enabled:
            default: false
            type: boolean
        type: object
    type: object
  velero:
    additionalProperties: false
    properties:
      enabled:
        default: true
        type: boolean
      uploaderType:
        enum:
          - restic
          - kopia
        type: string
      nodeAgent:
        additionalProperties: false
        properties:
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
        type: object
      nodeSelector:
        $ref: '#/$defs/kubernetesNodeSelector'
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
      retentionPeriod:
        $ref: '#/$defs/goDuration'
        default: 720h0m0s
      schedule:
        default: 0 0 * * *
        type: string
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
      storagePrefix:
        type: string
        examples:
          - workload-cluster
      excludedNamespaces:
        description: Excluded namespaces
        type: array
        items:
          type: string
      excludedExtraNamespaces:
        description: Extra excluded namespace, here we should add the namespaces that are more likely to change
        type: array
        items:
          type: string
    type: object
  clusterAdmin:
    additionalProperties: false
    properties:
      groups:
        items:
          type: string
        type: array
      users:
        items:
          type: string
        type: array
    type: object
  dex:
    additionalProperties: false
    dependentRequred:
      enableStaticLogin:
        - staticPassword
    properties:
      additionalKubeloginRedirects:
        items:
          examples:
            - http://localhost:8080/redirect
          format: uri
          type: string
        type: array
      affinity:
        $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
      enableStaticLogin:
        default: true
        description: enable a static password login
        type: boolean
      expiry:
        additionalProperties: false
        properties:
          deviceRequests:
            $ref: '#/$defs/timeRange'
            default: 5m
          idToken:
            $ref: '#/$defs/timeRange'
            default: 24h
          refreshTokens:
            additionalProperties: false
            properties:
              absoluteLifetime:
                $ref: '#/$defs/timeRange'
                default: 3960h
              reuseInterval:
                $ref: '#/$defs/timeRange'
                default: 3s
              validIfNotUsedFor:
                $ref: '#/$defs/timeRange'
                default: 2160h
            type: object
          signingKeys:
            default: 6h
            type: string
        type: object
      google:
        additionalProperties: false
        if:
          properties:
            groupSupport:
              const: true
        properties:
          SASecretName:
            type: string
          groupSupport:
            default: false
            type: boolean
        then:
          required:
            - SASecretName
        type: object
      nodeSelector:
        $ref: '#/$defs/kubernetesNodeSelector'
      replicaCount:
        default: 2
        type: number
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
      serviceMonitor:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
        type: object
      staticPassword:
        default: $2a$10$2b2cU8CPhOTaGrs1HRQuAueS7JTT5ZHsHSzYiFPm1leZck7Mc8T4W
        description: bcrypt hash of a password
        type: string
      subdomain:
        default: dex
        type: string
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
      topologySpreadConstraints:
        $ref: '#/$defs/kubernetesTopologySpreadConstraints'
    type: object
  externalTrafficPolicy:
    additionalProperties: false
    properties:
      local:
        default: false
        type: boolean
      whitelistRange:
        additionalProperties:
          default: 0.0.0.0/0
          type:
            - string
            - boolean
        description: |-
          CIDR IP ranges that enable various
          `nginx.ingress.kubernetes.io/whitelist-source-range` annotations or a
          boolean `false` to explicitly opt-out of the annotation.
        title: IP range allow-lists
        type: object
    type: object
  falco:
    additionalProperties: false
    description: |
      Falco alerting configuration.

      Available rule files and addons can be found at: <https://falcosecurity.github.io/falcoctl/index.yaml>
    properties:
      affinity:
        $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
      alerts:
        additionalProperties: false
        description: Falco alerts will come from prometheus metrics
        properties:
          enabled:
            default: false
            type: boolean
          hostPort:
            default: http://alertmanager-operated.monitoring:9093
            format: uri
            type: string
          priority:
            default: notice
            type: string
          type:
            default: alertmanager
            enum:
              - alertmanager
              - slack
            type: string
        type: object
      artifact:
        additionalProperties: false
        properties:
          install:
            additionalProperties: false
            description: set to false in an air-gapped environment, unless artifacts are self-hosted
            properties:
              enabled:
                type: boolean
            type: object
        type: object
      customIndexes:
        type: array
      customRules:
        additionalProperties:
          format: yaml
          type: string
        type: object
      driver:
        properties:
          kind:
            default: kmod
            type: string
            enum:
              - kmod
              - ebpf
              - modern-bpf
        type: object
        if:
          properties:
            kind:
              const: kmod
        then:
          properties:
            module:
              additionalProperties: false
              description: override the URL used for downloading driver modules, e.g. to use a self hosted file server in an air-gapped environment
              properties:
                repoURL:
                  oneOf:
                    - contst: ""
                    - format: uri
                  type: string
              type: object
        else:
          properties:
            kind:
              type: string
              enum:
                - ebpf
                - modern-bpf
            ebpf:
              additionalProperties: false
              properties:
                hostNetwork:
                  description: Needed to enable eBPF JIT at runtime for performance reasons. Can be skipped if eBPF JIT is enabled from outside the container
                  default: false
                  type: boolean
                path:
                  description: Path where the eBPF probe is located. It comes in handy when the probe have been installed in the nodes using tools other than the init container deployed with the chart.
                  type:
                    - string
                    - "null"
                  $comment: Phase out the null default from the default config eventually
              type: object
      enabled:
        default: true
        type: boolean
      falcoExporter:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
        type: object
      falcoSidekick:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
        type: object
      nodeSelector:
        $ref: '#/$defs/kubernetesNodeSelector'
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
      rulesFiles:
        additionalProperties: false
        properties:
          default:
            additionalProperties: false
            properties:
              enabled:
                default: true
                type: boolean
              version:
                default: 2.0.0
                type: string
            type: object
          incubating:
            additionalProperties: false
            properties:
              enabled:
                default: false
                type: boolean
              version:
                default: 2.0.0
                type: string
            type: object
          sandbox:
            additionalProperties: false
            properties:
              enabled:
                default: false
                type: boolean
              version:
                default: 2.0.0
                type: string
            type: object
        type: object
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
      tty:
        default: true
        type: boolean
    type: object
  gatekeeper:
    title: Open Policy Agent Gatekeeper configuration
    type: object
    properties:
      allowUserCRDs:
        properties:
          enabled:
            type: boolean
          enforcement:
            type: string
          adminConfUser:
            description: |-
              The name of the user specified in /etc/kubernetes/admin.conf kubeconfig file of the control plane nodes
              Necessary if Kubespray is used for managing the k8s cluster.
            type: string
          extraCRDs:
            type: array
            items:
              type: object
              properties:
                names:
                  type: array
                  items:
                    type: string
                group:
                  type: string
          extraServiceAccounts:
            type: array
            items:
              type: object
              properties:
                namespace:
                  type: string
                name:
                  type: string
              additionalProperties: false
      enabled:
        type: boolean
    additionalProperties: false
  kured:
    additionalProperties: false
    properties:
      affinity:
        $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
      configuration:
        $comment: Would it be possible to extract schema from somewhere else in the future?
        description: |-
          Passed through as-is to Kured chart
          See <helmfile.d/upstream/kubereboot/kured/README.md#Configuration>
        properties: {}
        type: object
      drainTimeout: true
      dsAnnotations:
        type: object
      enabled:
        default: false
        type: boolean
      endTime: true
      extraArgs:
        type: object
      extraEnvVars:
        type: object
      metrics:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          interval:
            default: 60s
            type: string
          labels:
            type: object
        type: object
      nodeSelector:
        $ref: '#/$defs/kubernetesNodeSelector'
      notification:
        additionalProperties: false
        properties:
          slack:
            additionalProperties: false
            properties:
              channel:
                default: ""
                type: string
              enabled:
                default: false
                type: boolean
            type: object
        type: object
      period: true
      rebootDays: true
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
      startTime: true
      timeZone: true
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
    type: object
  opa:
    additionalProperties: false
    properties:
      audit:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
          topologySpreadConstraints:
            $ref: '#/$defs/kubernetesTopologySpreadConstraints'
          writeToRAMDisk:
            default: false
            type: boolean
        type: object
      auditChunkSize:
        default: 500
        type: number
      auditFromCache:
        default: false
        type: boolean
      auditIntervalSeconds:
        default: 600
        type: number
      constraintViolationsLimit:
        default: 20
        type: number
      controllerManager:
        $ref: '#/$defs/component'
      disallowedTags:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          enforcement:
            default: deny
            type: string
          tags:
            items:
              default: latest
              type: string
            type: array
        type: object
      imageRegistry:
        additionalProperties: false
        properties:
          URL:
            items:
              examples:
                - harbor.example.com
                - quay.io/jetstack/cert-manager-acmesolver
              type: string
            type: array
          enabled:
            default: true
            type: boolean
          enforcement:
            default: warn
            type: string
        type: object
      mutatingWebhookTimeoutSeconds:
        default: 5
        type: number
      mutations:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          jobTTL:
            additionalProperties: false
            properties:
              enabled:
                default: true
                type: boolean
              ttlSeconds:
                default: 604800
                type: number
            type: object
          ndots:
            additionalProperties: false
            properties:
              enabled:
                default: false
                type: boolean
              labelSelector:
                additionalProperties: false
                properties:
                  matchLabels: {}
                type: object
              ndotAmount:
                default: 3
                type: integer
            type: object
        type: object
      networkPolicies:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          enforcement:
            default: warn
            type: string
        type: object
      rejectLoadBalancerService:
        additionalProperties: false
        description: Prevent the creation of load balancer services when unsupported
        properties:
          enabled:
            type: boolean
          enforcement:
            default: deny
            enum:
              - dryrun
              - warn
              - deny
            type: string
        type: object
      resourceRequests:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          enforcement:
            default: deny
            enum:
              - dryrun
              - warn
              - deny
            type: string
        type: object
      validatingWebhookTimeoutSeconds:
        default: 5
        type: number
      minimumDeploymentReplicas:
        type: object
        properties:
          enabled:
            type: boolean
            default: true
          enforcemenct:
            type: string
            default: warn
            enum:
              - dryrun
              - warn
              - deny
    type: object
  trivy:
    additionalProperties: false
    patternProperties:
      \w+Enabled$:
        $comment: |-
          This definition applies to any key that ends with 'Enabled', which are all
          booleans. In the future it may be desirable to replace this with individual
          entries under `properties` in order to provide documentation for each
          scanner.
        description: Enable or disable various security scanners
        type: boolean
    properties:
      affinity:
        $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
      enabled:
        default: true
        type: boolean
      excludeNamespaces:
        description: comma separated list of namespaces (or glob patterns) to be excluded from scanning
        type: string
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
      scanJobs:
        additionalProperties: false
        properties:
          concurrentLimit:
            default: 1
            type: number
          retryDelay:
            default: 1m
            type: string
          timeout:
            default: 5m
            type: string
        type: object
      scanner:
        additionalProperties: false
        description: |
          configurations for an offline / air-gapped environment
          ref: <https://github.com/aquasecurity/trivy-operator/tree/main/deploy/helm#values>
        properties:
          additionalProperties: false
          dbRegistry:
            type: string
          dbRepository:
            type: string
          dbRepositoryInsecure:
            type: boolean
          imagePullSecret:
            additionalProperties: false
            description: |
              if authorization is required for pulling from registry, create a pull
              secret in the monitoring namespace and configure the secret name
            properties:
              name:
                type: string
            type: object
          javaDbRegistry:
            type: string
          javaDbRepository:
            type: string
          offlineScanEnabled:
            type: boolean
          registry:
            examples:
              - docker.io: registry.example.org:5000
                gcr.io: registry.example.org:5000
                ghcr.io: registry.example.org:5000
                index.docker.io: registry.example.org:5000
                quay.io: registry.example.org:5000
                registry.k8s.io: registry.example.org:5000
            properties:
              mirror:
                additionalProperties:
                  description: a docker registry
                  examples:
                    - registry.example.org:5000
                  type: string
                type: object
            type: object
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          timeout:
            $ref: '#/$defs/goDuration'
        type: object
      serviceMonitor:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          interval:
            $ref: '#/$defs/timeRange'
        type: object
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
      vulnerabilityScanner:
        additionalProperties: false
        properties:
          scanOnlyCurrentRevisions:
            default: true
            type: boolean
          scannerReportTTL:
            $ref: '#/$defs/timeRange'
            default: 720h
        type: object
    required:
      - enabled
    title: Trivy security scanner
    type: object
  alerts:
    title: Alerting
    additionalProperties: false
    properties:
      alertTo:
        type: string
      customReceivers:
        type: array
      opsGenie:
        additionalProperties: false
        properties:
          apiUrl:
            default: https://api.eu.opsgenie.com
            format: uri
            type: string
        type: object
      opsGenieHeartbeat:
        additionalProperties: false
        if:
          properties:
            enabled:
              const: true
        properties:
          enabled:
            default: false
            type: boolean
          name:
            type: string
          url:
            default: https://api.eu.opsgenie.com/v2/heartbeats
            format: uri
            type: string
        required:
          - enabled
        then:
          required:
            - name
        type: object
      slack:
        additionalProperties: false
        properties:
          channel:
            type: string
          customTemplate:
            type: object
        type: object
    type: object
  grafana:
    title: Grafana
    additionalProperties: false
    properties:
      ops:
        additionalProperties: false
        properties:
          additionalConfigValues:
            type: object
          additionalDatasources:
            type: object
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          enabled:
            default: true
            type: boolean
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          oidc:
            additionalProperties: false
            properties:
              allowedDomains:
                items:
                  type: string
                type: array
              enabled:
                default: true
                type: boolean
              scopes:
                default: openid profile email groups
                type: string
              userGroups:
                additionalProperties: false
                properties:
                  grafanaAdmin:
                    default: grafana_admin
                    type: string
                  grafanaEditor:
                    default: grafana_editor
                    type: string
                  grafanaViewer:
                    default: grafana_viewer
                    type: string
                type: object
              skipRoleSync:
                type: boolean
            type: object
          plugins:
            type: array
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          sidecar:
            additionalProperties: false
            properties:
              resources:
                $ref: '#/$defs/kubernetesResourceRequirements'
            type: object
          subdomain:
            default: grafana
            type: string
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
          trailingDots:
            default: true
            type: boolean
          viewersCanEdit:
            default: true
            type: boolean
        type: object
      user:
        $ref: '#/properties/grafana/properties/ops'
    type: object
  grafanaLabelEnforcer:
    title: Grafana Label Enforcer
    additionalProperties: false
    properties:
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
    type: object
  kubeStateMetrics:
    title: Kubernetes Metrics
    additionalProperties: false
    properties:
      clusterAPIMetrics:
        additionalProperties: false
        properties:
          enabled:
            default: false
            type: boolean
        type: object
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
    type: object
  metricsServer:
    additionalProperties: false
    properties:
      enabled:
        default: true
        type: boolean
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
    type: object
  openstackMonitoring:
    title: Openstack Monitoring
    additionalProperties: false
    properties:
      enabled:
        default: false
        type: boolean
    type: object
  prometheus:
    title: Prometheus
    additionalProperties: false
    properties:
      affinity:
        $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
      alertmanagerSpec:
        additionalProperties: false
        properties:
          groupBy:
            items:
              default: '...'
              type: string
            type: array
          replicas:
            default: 2
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          storage:
            additionalProperties: false
            properties:
              volumeClaimTemplate:
                additionalProperties: false
                properties:
                  spec:
                    additionalProperties: false
                    properties:
                      accessModes:
                        items:
                          default: ReadWriteOnce
                          type: string
                        type: array
                      resources:
                        $ref: '#/$defs/kubernetesResourceRequirements'
                    type: object
                type: object
            type: object
          topologySpreadConstraints:
            $ref: '#/$defs/kubernetesTopologySpreadConstraints'
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
        type: object
      capacityManagementAlerts:
        additionalProperties:
          type: number
        properties:
          disklimit:
            default: 75
            type: number
          enabled:
            default: true
            type: boolean
          persistentVolume:
            additionalProperties: false
            properties:
              enabled:
                default: true
                type: boolean
              limit:
                default: 75
                type: number
            type: object
          requestlimit:
            additionalProperties: false
            properties:
              cpu:
                items:
                  additionalProperties: false
                  properties:
                    limit:
                      examples:
                        - 80
                      type: number
                    name:
                      examples:
                        - worker
                        - elastisys
                      type: string
                    pattern:
                      examples:
                        - .*-worker-.*
                        - .*-elastisys-.*
                      type: string
                  type: object
                type: array
              memory:
                items:
                  additionalProperties: false
                  properties:
                    limit:
                      examples:
                        - 80
                      type: number
                    name:
                      default: worker
                      type: string
                    pattern:
                      default: .*-worker-.*
                      type: string
                  type: object
                type: array
            type: object
          usagelimit:
            default: 95
            type: number
          predictUsage:
            type: boolean
        type: object
      diskAlerts:
        additionalProperties: false
        properties:
          inode:
            additionalProperties: false
            properties:
              predictLinear:
                items:
                  additionalProperties: false
                  properties:
                    for:
                      $ref: '#/$defs/timeRange'
                      default: 1h
                    freeSpacePercentage:
                      $ref: '#/$defs/percentage'
                      default: 40
                    hours:
                      default: 24
                      type: number
                    pattern:
                      additionalProperties: false
                      properties:
                        exclude:
                          additionalProperties: false
                          properties:
                            disk:
                              default: ""
                              type: string
                            node:
                              default: ""
                              type: string
                          type: object
                        include:
                          additionalProperties: false
                          properties:
                            disk:
                              default: .*
                              type: string
                            node:
                              default: .*
                              type: string
                          type: object
                      type: object
                    severity:
                      default: warning
                      type: string
                  type: object
                type: array
              space:
                items:
                  additionalProperties: false
                  properties:
                    for:
                      $ref: '#/$defs/timeRange'
                      default: 1h
                    freeSpacePercentage:
                      $ref: '#/$defs/percentage'
                      default: 5
                    pattern:
                      additionalProperties: false
                      properties:
                        exclude:
                          additionalProperties: false
                          properties:
                            disk:
                              default: ""
                              type: string
                            node:
                              default: ""
                              type: string
                          type: object
                        include:
                          additionalProperties: false
                          properties:
                            disk:
                              default: .*
                              type: string
                            node:
                              default: .*
                              type: string
                          type: object
                      type: object
                    severity:
                      default: warning
                      type: string
                  type: object
                type: array
            type: object
          perf:
            additionalProperties: false
            properties:
              enabled:
                type: boolean
              queueSizeThreshold:
                type: number
              readWaitTimeThreshold:
                type: number
              writeWaitTimeThreshold:
                type: number
            type: object
          storage:
            additionalProperties: false
            properties:
              predictLinear:
                items:
                  additionalProperties: false
                  properties:
                    for:
                      $ref: '#/$defs/timeRange'
                      default: 1h
                    freeSpacePercentage:
                      $ref: '#/$defs/percentage'
                      default: 30
                    hours:
                      default: 24
                      type: number
                    pattern:
                      additionalProperties: false
                      properties:
                        exclude:
                          additionalProperties: false
                          properties:
                            disk:
                              default: ""
                              type: string
                            node:
                              default: ""
                              type: string
                          type: object
                        include:
                          additionalProperties: false
                          properties:
                            disk:
                              default: .*
                              type: string
                            node:
                              default: .*
                              type: string
                          type: object
                      type: object
                    severity:
                      default: warning
                      type: string
                  type: object
                type: array
              space:
                items:
                  additionalProperties: false
                  properties:
                    for:
                      default: 30m
                      type: string
                    freeSpacePercentage:
                      $ref: '#/$defs/percentage'
                      default: 5
                    pattern:
                      additionalProperties: false
                      properties:
                        exclude:
                          additionalProperties: false
                          properties:
                            disk:
                              default: ""
                              type: string
                            node:
                              default: ""
                              type: string
                          type: object
                        include:
                          additionalProperties: false
                          properties:
                            disk:
                              default: .*
                              type: string
                            node:
                              default: .*
                              type: string
                          type: object
                      type: object
                    severity:
                      default: warning
                      type: string
                  type: object
                type: array
            type: object
        type: object
      nodeSelector:
        $ref: '#/$defs/kubernetesNodeSelector'
      replicas:
        default: 1
        type: number
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
      retention:
        additionalProperties: false
        properties:
          age:
            default: 3d
            type: string
          alertmanager:
            $ref: '#/$defs/timeRange'
            default: 72h
          size:
            default: 4GiB
            type: string
        type: object
      s3BucketAlerts:
        additionalProperties: false
        properties:
          exclude:
            type: array
          objects:
            additionalProperties: false
            properties:
              count:
                default: 1638400
                type: number
              enabled:
                default: false
                type: boolean
              percent:
                $ref: '#/$defs/percentage'
                default: 80
            type: object
          size:
            type: object
            additionalProperties: false
            properties:
              enabled:
                default: false
                type: boolean
              percent:
                $ref: '#/$defs/percentage'
                default: 80
              sizeQuotaGB:
                default: 1000
                type: number
          totalSize:
            type: object
            additionalProperties: false
            properties:
              enabled:
                default: false
                type: boolean
              percent:
                $ref: '#/$defs/percentage'
                default: 80
              sizeQuotaGB:
                default: 1000
                type: number
        type: object
      storage:
        additionalProperties: false
        properties:
          enabled:
            default: false
            type: boolean
          size:
            default: 5Gi
            type: string
        type: object
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
      topologySpreadConstraints:
        $ref: '#/$defs/kubernetesTopologySpreadConstraints'
      webhookAlerts:
        type: object
        properties:
          enabled:
            type: boolean
      additionalScrapeConfigs:
        type: array
        title: Additional prometheus scrape config.
        description: |
          Ref: <https://prometheus.io/docs/prometheus/latest/configuration/configuration/#scrape_config>
    type: object
  prometheusBlackboxExporter:
    $title: Prometheus Blackbox Exporter
    additionalProperties: false
    properties:
      customKubeapiTargets:
        items:
          properties:
            domain:
              format: hostname
              type: string
            name:
              type: string
          type: object
        type: array
      hostAliases:
        items:
          properties:
            hostNames:
              items:
                type: string
              type: array
            ip:
              format: ipv4
              type: string
          type: object
        type: array
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
      targets:
        properties:
          additionalProperties:
            type: boolean
        type: object
    type: object
  prometheusNodeExporter:
    title: Prometheus Node Exporter
    additionalProperties: false
    properties:
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
    type: object
  prometheusOperator:
    title: Prometheus Operator
    additionalProperties: false
    properties:
      prometheusConfigReloader:
        additionalProperties: false
        properties:
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
    type: object
  s3Exporter:
    title: S3 Exporter
    additionalProperties: false
    properties:
      affinity:
        $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
      enabled:
        default: true
        type: boolean
      interval:
        default: 60m
        type: string
      nodeSelector:
        $ref: '#/$defs/kubernetesNodeSelector'
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
      scrapeTimeout:
        default: 10m
        type: string
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
    type: object
  thanos:
    title: Thanos
    additionalProperties: false
    properties:
      bucketweb:
        additionalProperties: false
        properties:
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      compactor:
        additionalProperties: false
        properties:
          deduplication:
            default: none
            type: string
          persistence:
            additionalProperties: false
            properties:
              enabled:
                default: true
                type: boolean
              size:
                default: 8Gi
                type: string
            type: object
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          retentionResolution1h:
            $ref: '#/$defs/timeRange'
            default: 0s
          retentionResolution5m:
            $ref: '#/$defs/timeRange'
            default: 90d
          retentionResolutionRaw:
            $ref: '#/$defs/timeRange'
            default: 30d
          verticalCompaction:
            default: false
            type: boolean
        type: object
      enabled:
        default: true
        type: boolean
      metrics:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          serviceMonitor:
            additionalProperties: false
            properties:
              enabled:
                default: true
                type: boolean
            type: object
        type: object
      objectStorage:
        additionalProperties: false
        properties:
          type:
            default: ""
            type: string
        type: object
      query:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          replicaCount:
            default: 1
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          topologySpreadConstraints:
            $ref: '#/$defs/kubernetesTopologySpreadConstraints'
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
        type: object
      queryFrontend:
        additionalProperties: false
        properties:
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      receiveDistributor:
        additionalProperties: false
        properties:
          replicationFactor:
            default: 1
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      receiver:
        additionalProperties: false
        properties:
          basic_auth:
            additionalProperties: false
            properties:
              username:
                default: thanos
                type: string
            type: object
          enabled:
            default: true
            type: boolean
          mode:
            default: dual-mode
            type: string
          outOfOrderTimeWindow:
            default: 600s
            type: string
          persistence:
            additionalProperties: false
            properties:
              enabled:
                default: true
                type: boolean
              size:
                default: 50Gi
                type: string
            type: object
          replicaCount:
            default: 2
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          subdomain:
            default: thanos-receiver
            type: string
          topologySpreadConstraints:
            $ref: '#/$defs/kubernetesTopologySpreadConstraints'
          tsdbRetention:
            default: 15d
            type: string
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
        type: object
      ruler:
        additionalProperties: false
        properties:
          configReloader:
            additionalProperties: false
            properties:
              resources:
                $ref: '#/$defs/kubernetesResourceRequirements'
            type: object
          enabled:
            default: true
            type: boolean
          persistence:
            additionalProperties: false
            properties:
              enabled:
                default: false
                type: boolean
              size:
                default: 8Gi
                type: string
            type: object
          replicaCount:
            default: 2
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          topologySpreadConstraints:
            $ref: '#/$defs/kubernetesTopologySpreadConstraints'
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
        type: object
      storegateway:
        additionalProperties: false
        properties:
          persistence:
            additionalProperties: false
            properties:
              size:
                default: 8Gi
                type: string
            type: object
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
    type: object
  wcProbeIngress:
    title: Workcload Cluster Ingress Probe
    additionalProperties: false
    properties:
      enabled:
        type: boolean
    type: object
  welcomingDashboard:
    title: Welcoming Dashboard
    additionalProperties: false
    description: |-
      If you want to add extra text to the grafana/opensearch "welcoming dashboards"
      then write the text in these values as a one-line string.
      Note, first line of the string is a header, not all characters are supported.
      For newline in Grafana dashboard use format `\\n`
    properties:
      extraTextGrafana:
        description: Extra text added to the Grafana welcoming dashboard.
        examples:
          - Hello\n\n[This is an example link](https:/elastisys.io)
        format: markdown
        type: string
      extraTextOpensearch:
        description: Extra text added to the Opensearch welcoming dashboard.
        format: markdown
        type: string
      extraVersions:
        description: List of additional components to list on the welcoming dashboard.
        items:
          additionalProperties: false
          properties:
            name:
              description: Name of the component.
              examples:
                - Dex
                - Postgres
              type: string
            releasenotes:
              description: Link to release notes for the component
              examples:
                - https://elastisys.io/compliantkubernetes/release-notes/
              format: uri
              type: string
            subdomain:
              description: Link to a subdomain of `.global.baseDomain`
              format: hostname
              type: string
            url:
              description: Link to a full URL, instead of `subdomain`
              examples:
                - https://www.postgresql.org/
              format: uri
              type: string
            version:
              description: Version number.
              examples:
                - v2.37
                - "11"
              type: string
          required:
            - name
          type: object
        type: array
    type: object
  fluentd:
    title: Fluentd
    additionalProperties: false
    properties:
      aggregator:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          buffer:
            $ref: '#/$defs/fluentdBuffer'
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          persistence:
            additionalProperties: false
            properties:
              storage:
                default: 10Gi
                type: string
            type: object
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
        type: object
      audit:
        additionalProperties: false
        properties:
          compaction:
            additionalProperties: false
            properties:
              days:
                default: 10
                type: number
              enabled:
                default: true
                type: boolean
              ephemeralVolumes:
                additionalProperties: false
                properties:
                  enabled:
                    default: false
                    type: boolean
                type: object
              schedule:
                default: 0 1/6 * * *
                type: string
            type: object
          enabled:
            default: false
            type: boolean
          filters:
            default: ""
            description: Add filter stages to capture audit logs, add the audit tag prefix
            type: string
          retention:
            additionalProperties: false
            properties:
              days:
                default: 30
                type: number
              enabled:
                default: true
                type: boolean
              schedule:
                default: 0 20 * * *
                type: string
            type: object
        type: object
      enabled:
        default: true
        type: boolean
      forwarder:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          buffer:
            type: object
          livenessThresholdSeconds:
            default: 900
            type: number
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          requestTimeout:
            default: 60s
            type: string
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          stuckThresholdSeconds:
            default: 1200
            type: number
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
          topologySpreadConstraints:
            $ref: '#/$defs/kubernetesTopologySpreadConstraints'
        type: object
      logManager:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          compaction:
            additionalProperties: false
            properties:
              resources:
                $ref: '#/$defs/kubernetesResourceRequirements'
              volume:
                additionalProperties: false
                properties:
                  storage:
                    default: 5Gi
                    type: string
                type: object
            type: object
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          retention:
            additionalProperties: false
            properties:
              resources:
                $ref: '#/$defs/kubernetesResourceRequirements'
            type: object
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
        type: object
      scLogs:
        additionalProperties: false
        properties:
          compaction:
            additionalProperties: false
            properties:
              days:
                default: 7
                type: number
              enabled:
                default: true
                type: boolean
              ephemeralVolumes:
                additionalProperties: false
                properties:
                  enabled:
                    default: false
                    type: boolean
                type: object
              schedule:
                default: 0 2/6 * * *
                type: string
            type: object
          enabled:
            default: true
            type: boolean
          retention:
            additionalProperties: false
            properties:
              days:
                default: 7
                type: number
              enabled:
                default: true
                type: boolean
              schedule:
                default: 0 21 * * *
                type: string
            type: object
        type: object
      user:
        $ref: '#/$defs/component'
      extraConfigMaps:
        type: object
        description: |
          Extra fluentd config to mount.
        properties: {}
        additionalProperties:
          type: string
          description: configmap content
    type: object
  opensearch:
    title: OpenSearch
    additionalProperties: false
    properties:
      additionalTemplates:
        type: object
      clientNode:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          count:
            default: 1
            type: number
          dedicatedPods:
            default: true
            type: boolean
          javaOpts:
            default: -Xms512m -Xmx512m
            type: string
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
        type: object
      clusterName:
        default: opensearch
        type: string
      createIndices:
        default: true
        description: Create initial indices upon first startup
        type: boolean
      curator:
        additionalProperties: false
        properties:
          activeDeadlineSeconds:
            default: 2700
            type: number
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          enabled:
            default: true
            type: boolean
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          retention:
            items:
              additionalProperties: false
              properties:
                ageDays:
                  default: 7
                  type: number
                pattern:
                  default: other-*
                  type: string
                sizeGB:
                  default: 1
                  type: number
              type: object
            type: array
          startingDeadlineSeconds:
            default: 600
            type: number
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
        type: object
      dashboards:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          subdomain:
            default: opensearch
            type: string
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
          topologySpreadConstraints:
            $ref: '#/$defs/kubernetesTopologySpreadConstraints'
        type: object
      dataNode:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          count:
            default: 2
            type: number
          dedicatedPods:
            default: true
            type: boolean
          javaOpts:
            default: -Xms512m -Xmx512m
            type: string
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          storageClass:
            examples:
              - '-'
            type:
              - string
              - "null"
            description: |
              If null, no storageclass is specified in pvc and default storageClass is used
              if the DefaultStorageClass admission plugin is enabled.
              If "-", "" will be used as storageClassName.
          storageSize:
            default: 25Gi
            type: string
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
        type: object
      defaultTemplates:
        default: true
        type: boolean
      enabled:
        default: true
        type: boolean
      exporter:
        additionalProperties: false
        properties:
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          serviceMonitor:
            additionalProperties: false
            properties:
              interval:
                default: 30s
                type: string
              scrapeTimeout:
                default: 30s
                type: string
            type: object
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
        type: object
      extraRoleMappings:
        items:
          additionalProperties: false
          properties:
            definition:
              additionalProperties: false
              properties:
                backend_roles:
                  items:
                    type: string
                  type: array
                users:
                  items:
                    type: string
                  type: array
              type: object
            mapping_name:
              default: kibana_user
              type: string
          type: object
        type: array
      extraRoles:
        type: array
      indexPerNamespace:
        default: false
        type: boolean
      ingress:
        additionalProperties: false
        properties:
          maxbodysize:
            default: 32m
            type: string
        type: object
      ism:
        additionalProperties: false
        properties:
          additionalPolicies:
            type: object
          defaultPolicies:
            default: true
            type: boolean
          overwritePolicies:
            default: true
            type: boolean
          rolloverAgeDays:
            default: 1
            type: number
          rolloverSizeGB:
            default: 1
            type: number
        type: object
      masterNode:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          count:
            default: 1
            type: number
          javaOpts:
            default: -Xms512m -Xmx512m
            type: string
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          storageClass:
            type:
              - string
              - "null"
            description: |-
              If null, no storageclass is specified in pvc and default storageClass is used
              if the DefaultStorageClass admission plugin is enabled.
              If "-", "" will be used as storageClassName.
          storageSize:
            default: 8Gi
            type: string
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
        type: object
      maxClauseCount:
        default: 1024
        description: Change this value before applying opensearch to adjust indices.query.bool.max_clause_count
        type: number
      maxShardsPerNode:
        default: 1000
        type: number
      overwriteTemplates:
        default: true
        type: boolean
      plugins:
        additionalProperties: false
        properties:
          additionalPlugins:
            description: in an air-gapped environment this can be used to install plugins from known sources
            type: array
          installExternalObjectStoragePlugin:
            description: |-
              in an air-gapped environment where the nodes are not connected to the Internet, set
              following variable to false to prevent downloading external object storage plugin
            type: boolean
        type: object
      promIndexAlerts:
        items:
          additionalProperties: false
          properties:
            alertSizeMB:
              default: 5500
              type: number
            prefix:
              default: kubernetes-default
              type: string
          type: object
        type: array
      securityadmin:
        additionalProperties: false
        properties:
          activeDeadlineSeconds:
            default: 1200
            type: number
          enabled:
            default: true
            type: boolean
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      snapshot:
        additionalProperties: false
        properties:
          ageSeconds:
            default: 864000
            type: number
          backupActiveDeadlineSeconds:
            default: 600
            type: number
          backupSchedule:
            default: 0 */2 * * *
            type: string
          backupStartingDeadlineSeconds:
            default: 600
            type: number
          enabled:
            default: true
            type: boolean
          max:
            default: 14
            type: number
          maxRequestSeconds:
            default: 1200
            type: number
          min:
            default: 7
            type: number
          repository:
            default: opensearch-snapshots
            type: string
          retentionActiveDeadlineSeconds:
            default: 2700
            type: number
          retentionResources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          retentionSchedule:
            default: '@daily'
            type: string
          retentionStartingDeadlineSeconds:
            default: 600
            type: number
        type: object
      sso:
        additionalProperties: false
        properties:
          enabled:
            default: false
            type: boolean
          rolesKey:
            default: groups
            type: string
          scope:
            default: openid profile email groups
            type: string
          subjectKey:
            default: email
            type: string
        type: object
      subdomain:
        default: opensearch
        format: hostname
        type: string
    required:
      - enabled
      - subdomain
      - indexPerNamespace
      - dashboards
    type: object
  elasticsearch: true
additionalProperties:
  type: object
  properties: {}
