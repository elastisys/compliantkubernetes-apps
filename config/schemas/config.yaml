$schema: https://json-schema.org/draft/2020-12/schema
$id: https://github.com/elastisys/compliantkubernetes-apps/raw/main/config/schemas/config.yaml
title: Compliant Kubernetes Apps settings
description: |
  This describes the structure of the configuration for both the service
  cluster and the workload cluster, but keep in mind that each configuration
  file will contain different settings.
$defs:
  component:
    deprecated: true
    additionalProperties: false
    description: This is meant to describe the base class if you will, for ck8s resources.
    properties:
      affinity:
        $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
      enabled:
        type: boolean
      nodeSelector:
        $ref: '#/$defs/kubernetesNodeSelector'
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
      topologySpreadConstraints:
        $ref: '#/$defs/kubernetesTopologySpreadConstraints'
      extraArgs:
        $ref: '#/$defs/extraArgs'
    required: [] # Shouldn't at least 'enabled' be required?
    title: Common Resource
    type: object
  cpumem:
    deprecated: true
    description: |
      Use `.$defs.kubernetesQuantity` instead.
    additionalProperties: false
    properties:
      cpu:
        default: 100m
        pattern: ^[1-9][0-9]*m?$
        type:
          - string
          - integer
      memory:
        default: 128Mi
        pattern: ^[0-9]+(\.[0-9]+)?([KMG]i)?$
        type:
          - string
          - integer
    title: CPU and Memory specifications
    type: object
  extraArgs:
    items:
      type: string
    title: Extra arguments
    description: Extra arguments passed to a container
    type: array
  fluentdBuffer:
    additionalProperties:
      $comment: Assuming that these are never structures, only scalars
      not:
        type:
          - object
          - array
      type:
        - string
        - integer
        - boolean
    properties:
      chunkLimitSize:
        examples:
          - 50MB
        type: string
      flushInterval:
        examples:
          - 15m
        type: string
      flushMode:
        examples:
          - interval
        type: string
      flushThreadBurstInterval:
        type: number
      flushThreadCount:
        type: integer
      retryForever:
        type: boolean
      retryMaxInterval:
        type: integer
      retryType:
        examples:
          - exponential_backoff
        type: string
      timekey:
        examples:
          - 10m
        type: string
      timekeyUseUtc:
        type: boolean
      timekeyWait:
        examples:
          - 1m
        type: string
      totalLimitSize:
        examples:
          - 9GB
        type: string
    type: object
  goDuration:
    examples:
      - 2h45m0s
    pattern: ^([-+]?[0-9]+(.[0-9]+)?(ns|us|µs|ms|s|m|h))+$
    title: Duration string
    description: |
      A duration string is a possibly signed sequence of decimal numbers, each with optional fraction and a unit suffix, such as "300ms", "-1.5h" or "2h45m".
      Valid time units are "ns", "us" (or "µs"), "ms", "s", "m", "h".
    type: string
  iplist:
    title: List of IP netmasks
    items:
      type: string
      regex: ^[0-9a-f.:]{2,45}/[0-9]{1,3}$
      description: A IP address with netmask
      examples:
        - 0.0.0.0/0
        - 192.0.2.1/24
        - 2001:db8:0:1234::/64
    type: array
  netpolRule:
    title: IP and port list
    additionalProperties: false
    properties:
      enabled:
        type: boolean
      ips:
        $ref: '#/$defs/iplist'
      ports:
        $ref: '#/$defs/portlist'
    type: object
  kubernetesNodeSelector:
    additionalProperties:
      type: string
    examples:
      - kubernetes.io/os: linux
    type: object
  percentage:
    description: Percentage, 0% - 100%
    maximum: 100
    minimum: 0
    title: Percentage
    type: number
  port:
    maximum: 65535
    minimum: 1
    type:
      - integer
      - string
    regex: ^[0-9]{0,5}$
  portlist:
    title: Port number
    description: A 16 bit unsigned integer
    items:
      $ref: '#/$defs/port'
    type: array
  kubernetesResourceRequirements:
    title: Resource requirements
    description: |-
      Resource requests are used by the kube-scheduler to pick a node to schedule
      pods on. Limits are enforced. Resources are commonly 'cpu' and 'memory'.
    additionalProperties: false
    properties:
      requests:
        $ref: '#/$defs/kubernetesQuantityMap'
      limits:
        $ref: '#/$defs/kubernetesQuantityMap'
    type: object
    examples:
      - requests:
          memory: 128Mi
          cpu: 100m
        limits:
          memory: 256Mi
          cpu: 250m
  timeRange:
    examples:
      - 300s
      - 72h
      - 3d
    pattern: ^[0-9]+[hmsd]+$
    title: An amount of time
    type: string
  kubernetesTolerations:
    items:
      additionalProperties: false
      properties:
        effect:
          examples:
            - NoExecute
            - NoSchedule
            - PreferNoSchedule
          type: string
        key:
          examples:
            - node.kubernetes.io/memory-pressure
            - node.kubernetes.io/not-ready
            - node.kubernetes.io/unreachable
            - node-role.kubernetes.io/control-plane
            - node-role.kubernetes.io/master
          type: string
        operator:
          examples:
            - Exists
          type: string
        tolerationSeconds:
          type: integer
        value:
          type: string
      type: object
    type: array
  kubernetesTopologySpreadConstraints:
    items:
      additionalProperties: false
      properties:
        labelSelector:
          additionalProperties: false
          properties:
            matchLabels:
              additionalProperties:
                type: string
              properties: {}
              type: object
          type: object
        maxSkew:
          default: 1
          type: number
        topologyKey:
          default: kubernetes.io/hostname
          type: string
        whenUnsatisfiable:
          default: DoNotSchedule
          type: string
      type: object
    type: array
  kubernetesQuantityMap:
    type: object
    additionalProperties:
      $ref: '#/$defs/kubernetesQuantity'
  kubernetesQuantity:
    title: Quantity
    type:
      - string
      - number
    regex: ^[-+]?[0-9]+([KMGTPE]i|[eE][0-9]+|[mkMGTPE])?$
    description: |-
      Used for CPU shares, memory and storage size etc.

      See <https://github.com/kubernetes/apimachinery/blob/master/pkg/api/resource/quantity.go>
  io.k8s.api.core.v1.Affinity:
    description: Affinity is a group of affinity scheduling rules.
    properties:
      nodeAffinity:
        allOf:
          - $ref: '#/$defs/io.k8s.api.core.v1.NodeAffinity'
        description: Describes node affinity scheduling rules for the pod.
      podAffinity:
        allOf:
          - $ref: '#/$defs/io.k8s.api.core.v1.PodAffinity'
        description: Describes pod affinity scheduling rules (e.g. co-locate this pod in the same node, zone, etc. as some other pod(s)).
      podAntiAffinity:
        allOf:
          - $ref: '#/$defs/io.k8s.api.core.v1.PodAntiAffinity'
        description: Describes pod anti-affinity scheduling rules (e.g. avoid putting this pod in the same node, zone, etc. as some other pod(s)).
    type: object
  io.k8s.apimachinery.pkg.apis.meta.v1.LabelSelectorRequirement:
    description: A label selector requirement is a selector that contains values, a key, and an operator that relates the key and values.
    properties:
      key:
        default: ""
        description: key is the label key that the selector applies to.
        type: string
      operator:
        default: ""
        description: operator represents a key's relationship to a set of values. Valid operators are In, NotIn, Exists and DoesNotExist.
        type: string
      values:
        description: values is an array of string values. If the operator is In or NotIn, the values array must be non-empty. If the operator is Exists or DoesNotExist, the values array must be empty. This array is replaced during a strategic merge patch.
        items:
          default: ""
          type: string
        type: array
        x-kubernetes-list-type: atomic
    required:
      - key
      - operator
    type: object
  io.k8s.api.core.v1.NodeAffinity:
    description: Node affinity is a group of node affinity scheduling rules.
    properties:
      preferredDuringSchedulingIgnoredDuringExecution:
        description: The scheduler will prefer to schedule pods to nodes that satisfy the affinity expressions specified by this field, but it may choose a node that violates one or more of the expressions. The node that is most preferred is the one with the greatest sum of weights, i.e. for each node that meets all of the scheduling requirements (resource request, requiredDuringScheduling affinity expressions, etc.), compute a sum by iterating through the elements of this field and adding "weight" to the sum if the node matches the corresponding matchExpressions; the node(s) with the highest sum are the most preferred.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.PreferredSchedulingTerm'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
      requiredDuringSchedulingIgnoredDuringExecution:
        allOf:
          - $ref: '#/$defs/io.k8s.api.core.v1.NodeSelector'
        description: If the affinity requirements specified by this field are not met at scheduling time, the pod will not be scheduled onto the node. If the affinity requirements specified by this field cease to be met at some point during pod execution (e.g. due to an update), the system may or may not try to eventually evict the pod from its node.
    type: object
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.PodAffinity:
    description: Pod affinity is a group of inter pod affinity scheduling rules.
    properties:
      preferredDuringSchedulingIgnoredDuringExecution:
        description: The scheduler will prefer to schedule pods to nodes that satisfy the affinity expressions specified by this field, but it may choose a node that violates one or more of the expressions. The node that is most preferred is the one with the greatest sum of weights, i.e. for each node that meets all of the scheduling requirements (resource request, requiredDuringScheduling affinity expressions, etc.), compute a sum by iterating through the elements of this field and adding "weight" to the sum if the node has pods which matches the corresponding podAffinityTerm; the node(s) with the highest sum are the most preferred.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.WeightedPodAffinityTerm'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
      requiredDuringSchedulingIgnoredDuringExecution:
        description: If the affinity requirements specified by this field are not met at scheduling time, the pod will not be scheduled onto the node. If the affinity requirements specified by this field cease to be met at some point during pod execution (e.g. due to a pod label update), the system may or may not try to eventually evict the pod from its node. When there are multiple elements, the lists of nodes corresponding to each podAffinityTerm are intersected, i.e. all terms must be satisfied.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.PodAffinityTerm'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
    type: object
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.PodAntiAffinity:
    description: Pod anti affinity is a group of inter pod anti affinity scheduling rules.
    properties:
      preferredDuringSchedulingIgnoredDuringExecution:
        description: The scheduler will prefer to schedule pods to nodes that satisfy the anti-affinity expressions specified by this field, but it may choose a node that violates one or more of the expressions. The node that is most preferred is the one with the greatest sum of weights, i.e. for each node that meets all of the scheduling requirements (resource request, requiredDuringScheduling anti-affinity expressions, etc.), compute a sum by iterating through the elements of this field and adding "weight" to the sum if the node has pods which matches the corresponding podAffinityTerm; the node(s) with the highest sum are the most preferred.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.WeightedPodAffinityTerm'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
      requiredDuringSchedulingIgnoredDuringExecution:
        description: If the anti-affinity requirements specified by this field are not met at scheduling time, the pod will not be scheduled onto the node. If the anti-affinity requirements specified by this field cease to be met at some point during pod execution (e.g. due to a pod label update), the system may or may not try to eventually evict the pod from its node. When there are multiple elements, the lists of nodes corresponding to each podAffinityTerm are intersected, i.e. all terms must be satisfied.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.PodAffinityTerm'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
    type: object
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.PreferredSchedulingTerm:
    description: An empty preferred scheduling term matches all objects with implicit weight 0 (i.e. it's a no-op). A null preferred scheduling term matches no objects (i.e. is also a no-op).
    properties:
      preference:
        allOf:
          - $ref: '#/$defs/io.k8s.api.core.v1.NodeSelectorTerm'
        default: {}
        description: A node selector term, associated with the corresponding weight.
      weight:
        default: 0
        description: Weight associated with matching the corresponding nodeSelectorTerm, in the range 1-100.
        format: int32
        type: integer
    required:
      - weight
      - preference
    type: object
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.NodeSelector:
    description: A node selector represents the union of the results of one or more label queries over a set of nodes; that is, it represents the OR of the selectors represented by the node selector terms.
    properties:
      nodeSelectorTerms:
        description: Required. A list of node selector terms. The terms are ORed.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.NodeSelectorTerm'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
    required:
      - nodeSelectorTerms
    type: object
    x-kubernetes-map-type: atomic
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.WeightedPodAffinityTerm:
    description: The weights of all of the matched WeightedPodAffinityTerm fields are added per-node to find the most preferred node(s)
    properties:
      podAffinityTerm:
        allOf:
          - $ref: '#/$defs/io.k8s.api.core.v1.PodAffinityTerm'
        default: {}
        description: Required. A pod affinity term, associated with the corresponding weight.
      weight:
        default: 0
        description: weight associated with matching the corresponding podAffinityTerm, in the range 1-100.
        format: int32
        type: integer
    required:
      - weight
      - podAffinityTerm
    type: object
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.PodAffinityTerm:
    description: Defines a set of pods (namely those matching the labelSelector relative to the given namespace(s)) that this pod should be co-located (affinity) or not co-located (anti-affinity) with, where co-located is defined as running on a node whose value of the label with key <topologyKey> matches that of any node on which a pod of the set of pods is running
    properties:
      labelSelector:
        allOf:
          - $ref: '#/$defs/io.k8s.apimachinery.pkg.apis.meta.v1.LabelSelector'
        description: A label query over a set of resources, in this case pods. If it's null, this PodAffinityTerm matches with no Pods.
      matchLabelKeys:
        description: MatchLabelKeys is a set of pod label keys to select which pods will be taken into consideration. The keys are used to lookup values from the incoming pod labels, those key-value labels are merged with `labelSelector` as `key in (value)` to select the group of existing pods which pods will be taken into consideration for the incoming pod's pod (anti) affinity. Keys that don't exist in the incoming pod labels will be ignored. The default value is empty. The same key is forbidden to exist in both matchLabelKeys and labelSelector. Also, matchLabelKeys cannot be set when labelSelector isn't set. This is an alpha field and requires enabling MatchLabelKeysInPodAffinity feature gate.
        items:
          default: ""
          type: string
        type: array
        x-kubernetes-list-type: atomic
      mismatchLabelKeys:
        description: MismatchLabelKeys is a set of pod label keys to select which pods will be taken into consideration. The keys are used to lookup values from the incoming pod labels, those key-value labels are merged with `labelSelector` as `key notin (value)` to select the group of existing pods which pods will be taken into consideration for the incoming pod's pod (anti) affinity. Keys that don't exist in the incoming pod labels will be ignored. The default value is empty. The same key is forbidden to exist in both mismatchLabelKeys and labelSelector. Also, mismatchLabelKeys cannot be set when labelSelector isn't set. This is an alpha field and requires enabling MatchLabelKeysInPodAffinity feature gate.
        items:
          default: ""
          type: string
        type: array
        x-kubernetes-list-type: atomic
      namespaceSelector:
        allOf:
          - $ref: '#/$defs/io.k8s.apimachinery.pkg.apis.meta.v1.LabelSelector'
        description: A label query over the set of namespaces that the term applies to. The term is applied to the union of the namespaces selected by this field and the ones listed in the namespaces field. null selector and null or empty namespaces list means "this pod's namespace". An empty selector ({}) matches all namespaces.
      namespaces:
        description: namespaces specifies a static list of namespace names that the term applies to. The term is applied to the union of the namespaces listed in this field and the ones selected by namespaceSelector. null or empty namespaces list and null namespaceSelector means "this pod's namespace".
        items:
          default: ""
          type: string
        type: array
        x-kubernetes-list-type: atomic
      topologyKey:
        default: ""
        description: This pod should be co-located (affinity) or not co-located (anti-affinity) with the pods matching the labelSelector in the specified namespaces, where co-located is defined as running on a node whose value of the label with key topologyKey matches that of any node on which any of the selected pods is running. Empty topologyKey is not allowed.
        type: string
    required:
      - topologyKey
    type: object
    $comment: Imported from Kubernetes project
  io.k8s.apimachinery.pkg.apis.meta.v1.LabelSelector:
    description: A label selector is a label query over a set of resources. The result of matchLabels and matchExpressions are ANDed. An empty label selector matches all objects. A null label selector matches no objects.
    properties:
      matchExpressions:
        description: matchExpressions is a list of label selector requirements. The requirements are ANDed.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.apimachinery.pkg.apis.meta.v1.LabelSelectorRequirement'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
      matchLabels:
        additionalProperties:
          default: ""
          type: string
        description: matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels map is equivalent to an element of matchExpressions, whose key field is "key", the operator is "In", and the values array contains only "value". The requirements are ANDed.
        type: object
    type: object
    x-kubernetes-map-type: atomic
    $comment: Imported from Kubernetes project
  io.k8s.api.core.v1.NodeSelectorTerm:
    description: A null or empty node selector term matches no objects. The requirements of them are ANDed. The TopologySelectorTerm type implements a subset of the NodeSelectorTerm.
    properties:
      matchExpressions:
        description: A list of node selector requirements by node's labels.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.NodeSelectorRequirement'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
      matchFields:
        description: A list of node selector requirements by node's fields.
        items:
          allOf:
            - $ref: '#/$defs/io.k8s.api.core.v1.NodeSelectorRequirement'
          default: {}
        type: array
        x-kubernetes-list-type: atomic
    type: object
    x-kubernetes-map-type: atomic
  io.k8s.api.core.v1.NodeSelectorRequirement:
    description: A node selector requirement is a selector that contains values, a key, and an operator that relates the key and values.
    properties:
      key:
        default: ""
        description: The label key that the selector applies to.
        type: string
      operator:
        default: ""
        description: Represents a key's relationship to a set of values. Valid operators are In, NotIn, Exists, DoesNotExist. Gt, and Lt.
        type: string
      values:
        description: An array of string values. If the operator is In or NotIn, the values array must be non-empty. If the operator is Exists or DoesNotExist, the values array must be empty. If the operator is Gt or Lt, the values array must have a single element, which will be interpreted as an integer. This array is replaced during a strategic merge patch.
        items:
          default: ""
          type: string
        type: array
        x-kubernetes-list-type: atomic
    required:
      - key
      - operator
    type: object
    $comment: Imported from Kubernetes project
type: object
required:
  - global
properties:
  global:
    title: Global options
    description: Some common options used in various helm charts.
    type: object
    required:
      - ck8sVersion
      - ck8sCloudProvider
      - ck8sEnvironmentName
      - ck8sFlavor
      - baseDomain
      - opsDomain
    properties:
      ck8sVersion:
        title: Compliant Kubernetes Apps version
        description: |-
          Use version number if you are exactly at a release tag.
          Otherwise use full commit hash of current commit.
          `any`, can be used to disable this validation.
        type: string
        examples:
          - v0.42.1
          - any
          - 424442541a567646c232d949bad1af2b5b7cb885
      ck8sCloudProvider:
        type: string
        enum:
          - aws
          - azure
          - baremetal
          - citycloud
          - elastx
          - exoscale
          - none
          - safespring
          - upcloud
      ck8sEnvironmentName:
        title: Environment name
        type: string
        examples:
          - my-ck8s-cluster
      ck8sFlavor:
        type: string
        enum:
          - prod
          - dev
          - air-gapped
      baseDomain:
        title: Base Domain
        description: |-
          Domain intended for ingress usage in the workload cluster
          and to reach application developer facing services such as Grafana, Harbor and OpenSearch Dashboards.
          E.g. with 'prod.domain.com', OpenSearch Dashboards is reached via 'opensearch.prod.domain.com'.
        type: string
        format: hostname
      opsDomain:
        description: |-
          Domain intended for ingress usage in the service cluster and to reach
          non-user facing services such as Thanos and OpenSearch.
          E.g. with 'ops.prod.domain.com', OpenSearch is reached via 'opensearch.ops.prod.domain.com'.
        type: string
        format: hostname
      scDomain:
        description: If baseDomain for wc and sc are not the same, set the domain of the sc cluster.
        type: string
        oneOf: # Templates do not handle missing values so they must be empty strings to disable. Future FIXME?
          - const: ""
          - format: hostname
      scOpsDomain:
        description: If opsDomain for wc and sc are not the same, set the ops domain of the sc cluster.
        type: string
        oneOf:
          - const: ""
          - format: hostname
      issuer:
        description: |-
          Default cert-manager issuer to use for issuing certificates for ingresses.
          Normally one of `letsencrypt-staging` or `letsencrypt-prod`.
        type: string
        default: letsencrypt-staging
        enum:
          - letsencrypt-staging
          - letsencrypt-prod
      verifyTls:
        description: Verify ingress certificates
        type: boolean
        default: true
      clusterDns:
        description: IP of the cluster DNS in kubernetes
        type: string
        default: 10.233.0.3
        format: ip-address
      clusterName:
        type: string
      clustersMonitoring:
        description: |-
          Names of the workload clusters that sends metrics to this cluster.
          Mainly used for filtering of metrics.
        type: array
        items:
          type: string
          pattern: -[sw]c$
      containerRuntime:
        title: Container runtime
        default: containerd
        type: string
        enum:
          - containerd
          - docker
    additionalProperties: false
  clusterApi:
    additionalProperties: false
    properties:
      clusters:
        items:
          type: string
        type: array
      enabled:
        default: false
        type: boolean
      monitoring:
        additionalProperties: false
        properties:
          enabled:
            default: false
            type: boolean
        type: object
    type: object
  user:
    additionalProperties: false
    properties:
      adminGroups:
        items:
          type: string
        type: array
      adminUsers:
        items:
          examples:
            - admin@example.com
          type: string
        type: array
      constraints:
        additionalProperties:
          additionalProperties:
            properties: {}
            type: object
          properties: {}
          propertyNames:
            title: Service name
            type: string
          type: object
        description: |-
          Any namespace listed in constraints are exempted from HNC managed namespaces
          This to override the Pod Security Admission level
          Example of constraint can be found here: helmfile.d/charts/gatekeeper/podsecuritypolicies/values.yaml
          The only extra label "psaLevel: <baseline/privileged>" is shown in the following example:
          <namespace>:
            psaLevel: <baseline/privileged>
            <service-name>:
              ...
        properties: {}
        propertyNames:
          title: Namespace
          type: string
        type: object
      createNamespaces:
        type: boolean
        description: This only controls if the namespaces should be created, user RBAC is always created.
      grafanaPassword:
        type: string
      namespaces:
        items:
          examples:
            - production
            - staging
          type: string
        type: array
      serviceAccounts:
        items:
          type: string
        type: array
      alertmanager:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          enabled:
            type: boolean
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
          topologySpreadConstraints:
            $ref: '#/$defs/kubernetesTopologySpreadConstraints'
          ingress:
            type: object
            properties:
              enabled:
                type: boolean
          image:
            type: string
            examples:
              - quay.io/prometheus/alertmanager:vX.Y.Z
            description: Set to override the alertmanager container image
        type: object
      sealedSecrets:
        type: object
        properties:
          enabled:
            type: boolean
        additionalProperties: false
        title: sealedSecrets
        description: |-
          Installs required cluster resources needed to install sealedSecrets
          Requires that gatekeeper.allowUserCRDs.enabled is enabled.
      mongodb:
        description: |-
          Installs required cluster resources needed to install fluxv2
          Requires that gatekeeper.allowUserCRDs.enabled is enabled.
        type: object
        properties:
          enabled:
            type: boolean
        additionalProperties: false
        title: mongodb
      fluxv2:
        type: object
        properties:
          enabled:
            type: boolean
        additionalProperties: false
        title: fluxv2
        description: |-
          Installs required cluster resources needed to install fluxv2
          Requires that gatekeeper.allowUserCRDs.enabled is enabled.
      kafka:
        description: |-
          Installs required cluster resources needed to install kafka-operator
          Requires that gatekeeper.allowUserCRDs.enabled is enabled.
        type: object
        properties:
          enabled:
            type: boolean
        additionalProperties: false
        title: kafka
    type: object
    title: User configuration
  hnc:
    additionalProperties: false
    properties:
      additionalAllowPropagateResources:
        items:
          additionalProperties: false
          properties:
            group:
              examples:
                - networking.k8s.io
              type: string
            resource:
              examples:
                - networkpolicies
                - secrets
              type: string
          type: object
        type: array
      excludedExtraNamespaces:
        items:
          type: string
        type: array
      excludedNamespaces:
        items:
          examples:
            - alertmanager
            - cert-manager
            - falco
            - fluentd
            - fluentd-system
            - gatekeeper-system
            - hnc-system
            - ingress-nginx
            - kube-node-lease
            - kube-public
            - kube-system
            - kured
            - metallb-system
            - monitoring
            - rook-ceph
            - velero
          type: string
        type: array
      ha:
        type: boolean
      includedNamespacesRegex:
        type: string
      managedNamespaceAnnotations:
        items:
          type: string
        type: array
      managedNamespaceLabels:
        items:
          examples:
            - pod-security.kubernetes.io/audit
            - pod-security.kubernetes.io/enforce
            - pod-security.kubernetes.io/warn
          type: string
        type: array
      manager:
        $ref: '#/$defs/component'
      serviceMonitor:
        additionalProperties: false
        properties:
          relabelings:
            items: {}
            type: array
        type: object
      unpropagatedAnnotations:
        items: {}
        type: array
      webhook:
        additionalProperties: false
        properties:
          affinity:
            additionalProperties: false
            properties: {}
            type: object
          nodeSelector:
            additionalProperties: false
            properties: {}
            type: object
          replicaCount:
            type: integer
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          tolerations:
            items: {}
            type: array
          topologySpreadConstraints:
            items:
              additionalProperties: false
              properties:
                labelSelector:
                  additionalProperties: false
                  properties:
                    matchLabels:
                      additionalProperties: false
                      properties:
                        app.kubernetes.io/component:
                          examples:
                            - hnc-webhook
                          type: string
                      type: object
                  type: object
                maxSkew:
                  type: integer
                topologyKey:
                  examples:
                    - kubernetes.io/hostname
                  type: string
                whenUnsatisfiable:
                  examples:
                    - DoNotSchedule
                  type: string
              type: object
            type: array
        type: object
      webhookMatchConditions:
        type: boolean
      enabled:
        type: boolean
    type: object
  harbor:
    additionalProperties: false
    properties:
      alerts:
        additionalProperties: false
        properties:
          maxTotalArtifacts:
            default: 1000
            type: number
          maxTotalStorageUsedGB:
            default: 500
            type: number
        type: object
      backup:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          ephemeralBackupStore:
            properties:
              enabled:
                type: boolean
              storageSize:
                type: string
            type: object
          retentionDays:
            default: 7
            type: number
        type: object
      core:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          replicas:
            default: 1
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      database:
        additionalProperties: false
        properties:
          external:
            additionalProperties: false
            properties:
              coreDatabase:
                default: registry
                type: string
              notaryServerDatabase:
                default: notaryserver
                type: string
              notarySignerDatabase:
                default: notarysigner
                type: string
              port:
                default: "5432"
                type: string
              sslmode:
                default: disable
                enum:
                  - disable
                  - require
                  - verify-ca
                  - verify-full
                type: string
            type: object
          internal:
            additionalProperties: false
            properties:
              affinity:
                $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
              persistentVolumeClaim:
                additionalProperties: false
                properties:
                  size:
                    default: 1Gi
                    type: string
                type: object
              resources:
                $ref: '#/$defs/kubernetesResourceRequirements'
            type: object
          type:
            default: internal
            type: string
        type: object
      enabled:
        default: true
        type: boolean
      gc:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          forceConfigure:
            default: false
            type: boolean
          schedule:
            default: 0 0 0 * * SUN
            type: string
        type: object
      ingress:
        additionalProperties: false
        properties:
          additionalAnnotations:
            type: object
          defaultAnnotations:
            additionalProperties: false
            properties:
              nginx.ingress.kubernetes.io/proxy-buffering:
                default: off
                type: string
              nginx.ingress.kubernetes.io/proxy-request-buffering:
                default: off
                type: string
            type: object
        type: object
      jobservice:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          jobLog:
            additionalProperties: false
            properties:
              persistentVolumeClaim:
                additionalProperties: false
                properties:
                  size:
                    default: 1Gi
                    type: string
                type: object
            type: object
          jobLoggers:
            items:
              default: file
              type: string
            type: array
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          scanDataExports:
            additionalProperties: false
            properties:
              persistentVolumeClaim:
                additionalProperties: false
                properties:
                  size:
                    default: 1Gi
                    type: string
                type: object
            type: object
        type: object
      nodeSelector:
        $ref: '#/$defs/kubernetesNodeSelector'
      notary:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          replicas:
            default: 1
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          subdomain:
            default: notary.harbor
            type: string
        type: object
      notarySigner:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      oidc:
        additionalProperties: false
        properties:
          adminGroupName:
            type: string
          groupClaimName:
            default: groups
            type: string
          scope:
            default: openid,email,profile,offline_access,groups
            type: string
        type: object
      persistence:
        additionalProperties: false
        properties:
          disableRedirect:
            type: boolean
          type:
            type: string
        type: object
      portal:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          replicas:
            default: 1
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      redis:
        additionalProperties: false
        properties:
          external:
            additionalProperties: false
            properties:
              addr:
                examples:
                  - rfs-redis-harbor.redis-system.svc.cluster.local:26379
                type: string
              sentinelMasterSet:
                type: string
            type: object
          internal:
            additionalProperties: false
            properties:
              affinity:
                $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
              persistentVolumeClaim:
                additionalProperties: false
                properties:
                  size:
                    default: 1Gi
                    type: string
                type: object
              resources:
                $ref: '#/$defs/kubernetesResourceRequirements'
            type: object
          type:
            default: internal
            type: string
        type: object
      registry:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          controller:
            additionalProperties: false
            properties:
              resources:
                $ref: '#/$defs/kubernetesResourceRequirements'
            type: object
          persistentVolumeClaim:
            additionalProperties: false
            properties:
              size:
                default: 5Gi
                type: string
            type: object
          replicas:
            default: 1
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      s3:
        additionalProperties: false
        properties:
          multipartcopythresholdsize:
            default: "536870912"
            type: string
            $comment: turn into number?
          multipartcopychunksize:
            type:
              - integer
              - string
          multipartcopymaxconcurrency:
            type:
              - integer
              - string
        type: object
      subdomain:
        default: harbor
        type: string
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
      trivy:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          persistentVolumeClaim:
            additionalProperties: false
            properties:
              size:
                default: 5Gi
                type: string
            type: object
          replicas:
            default: 1
            type: number
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
      exporter:
        additionalProperties: false
        properties:
          external:
            additionalProperties: false
            properties:
              coreDatabase:
                examples:
                  - registry
                type: string
              port:
                examples:
                  - "5432"
                type: string
            type: object
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
        type: object
    type: object
  storageClasses:
    additionalProperties: false
    properties:
      default:
        type: string
    type: object
  objectStorage:
    additionalProperties: false
    description: Swift can be enabled separately for Harbor, Thanos and rclone-sync only.
    properties:
      buckets:
        additionalProperties:
          type: string
        description: Buckets where each respective application will store its backups.
        type: object
      s3:
        additionalProperties: false
        properties:
          accessKey:
            type: string
          forcePathStyle:
            description: Generally false when using AWS and Exoscale and true for other providers.
            type: boolean
          region:
            type: string
          regionEndpoint:
            description: S3 endpoint for non-AWS implementation of S3. Make sure to prepend the protocol (i.e., https:// or http://) with the URL, e.g., https://s3.sto1.safedc.net
            type: string
          secretKey:
            type: string
        type: object
      sync:
        additionalProperties: false
        properties:
          buckets:
            type: array
          defaultSchedule:
            default: 0 5 * * *
            type: string
          destinationType:
            default: s3
            type: string
          enabled:
            default: false
            type: boolean
          encrypt:
            additionalProperties: false
            properties:
              directoryNames:
                default: false
                type: boolean
              enabled:
                default: false
                type: boolean
              fileNames:
                default: false
                type: boolean
            type: object
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          s3:
            $ref: '#/properties/objectStorage/properties/s3'
          syncDefaultBuckets:
            default: false
            type: boolean
        type: object
      type:
        enum:
          - s3
          - gcs
          - none
        type: string
      swift:
        type: object
        properties:
          authVersion:
            type: number
          authUrl:
            type: string
            format: uri
          region:
            type: string
          domainId:
            type: string
          domainName:
            type: string
            format: hostname
          projectDomainId:
            type: string
          projectDomainName:
            type: string
            format: hostname
          projectId:
            type: string
          projectName:
            type: string
          segmentsContainerSuffix:
            type: string
      restore:
        type: object
        properties: {}
        $comment: TODO
    type: object
  rookCeph:
    additionalProperties: false
    properties:
      gatekeeperPsp:
        additionalProperties: false
        properties:
          enabled:
            default: false
            type: boolean
        type: object
      monitoring:
        additionalProperties: false
        properties:
          enabled:
            default: false
            type: boolean
        type: object
    type: object
  velero:
    additionalProperties: false
    properties:
      enabled:
        default: true
        type: boolean
      nodeAgent:
        additionalProperties: false
        properties:
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
        type: object
      nodeSelector:
        $ref: '#/$defs/kubernetesNodeSelector'
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
      retentionPeriod:
        $ref: '#/$defs/goDuration'
        default: 720h0m0s
      schedule:
        default: 0 0 * * *
        type: string
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
      storagePrefix:
        type: string
        examples:
          - workload-cluster
      excludedNamespaces:
        description: Excluded namespaces
        type: array
        items:
          type: string
      excludedExtraNamespaces:
        description: Extra excluded namespace, here we should add the namespaces that are more likely to change
        type: array
        items:
          type: string
    type: object
  calicoAccountant:
    additionalProperties: false
    properties:
      backend:
        default: iptables
        enum:
          - iptables
          - nftables
        type: string
      enabled:
        default: true
        type: boolean
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
    type: object
  calicoFelixMetrics:
    additionalProperties: false
    properties:
      enabled:
        default: true
        type: boolean
    type: object
  certmanager:
    additionalProperties: false
    properties:
      affinity:
        $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
      cainjector:
        $ref: '#/$defs/component'
      extraArgs:
        $ref: '#/$defs/extraArgs'
      nodeSelector:
        $ref: '#/$defs/kubernetesNodeSelector'
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
      tolerations:
        $ref: '#/$defs/kubernetesTolerations'
      topologySpreadConstraints:
        $ref: '#/$defs/kubernetesTopologySpreadConstraints'
      webhook:
        $ref: '#/$defs/component'
    type: object
  ingressNginx:
    additionalProperties: false
    properties:
      controller:
        additionalProperties: false
        properties:
          additionalConfig:
            type: object
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          allowSnippetAnnotations:
            default: false
            type: boolean
          chroot:
            type: boolean
          config:
            additionalProperties: false
            properties:
              useProxyProtocol:
                type: boolean
              annotationsRiskLevel:
                type: string
                description: See [reference](https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/configmap/#annotations-risk-level)
                enum:
                  - Critical
                  - High
                  - Medium
                  - Low
            type: object
          enablepublishService:
            default: false
            type: boolean
          enableAnnotationValidations:
            description: |-
              Enable validation of Nginx annotations on Ingress resources.
              This is kept false by default due to the maturity of the feature,
              e.g. lack of documentation and disruptive bugs.
            default: false
            type: boolean
          extraArgs: true
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          service:
            type: object
            oneOf:
              - properties:
                  enabled:
                    type: boolean
                    const: false
              - additionalProperties: false
                properties:
                  annotations:
                    additionalProperties:
                      type: string
                    type: object
                  clusterIP:
                    type: string
                    oneOf:
                      - format: ipv4
                      - const: ""
                  enabled:
                    type: boolean
                    const: true
                  loadBalancerSourceRanges:
                    items:
                      type: string
                    type: array
                  ipFamilyPolicy:
                    type: string
                    description: |-
                      Represents the dual-stack-ness requested or required by this Service. When
                      utilizing an internal loadbalancer service (ie MetalLB), set this field to
                      "RequireDualStack" if you want both IPv4 and IPv6 connectivity. The
                      ipFamilies and clusterIPs fields depend on the value of this field.

                      See [reference](https://kubernetes.io/docs/concepts/services-networking/dual-stack/)
                    enum:
                      - ""
                      - SingleStack
                      - PreferDualStack
                      - RequireDualStack
                    default: SingleStack
                  ipFamilies:
                    type: array
                    description: |-
                      List of IP families (e.g. IPv4, IPv6) assigned to the service. Default is IPv4 only. When utilizing an internal loadbalancer service (ie MetalLB),
                      IPv6 would also need to be included in order for the ingress service to allocate an address in that family.
                    uniqueItems: true
                    items:
                      type: string
                      enum:
                        - IPv4
                        - IPv6
                    default:
                      - IPv4
                  nodePorts:
                    additionalProperties: false
                    properties:
                      http:
                        default: 30080
                        $ref: '#/$defs/port'
                      https:
                        default: 30443
                        $ref: '#/$defs/port'
                    type: object
                  type:
                    description: See [reference](https://kubernetes.io/docs/concepts/services-networking/service/#publishing-services-service-types)
                    enum:
                      - ClusterIP
                      - NodePort
                      - LoadBalancer
                      - ExternalName
                    type: string
                  allocateLoadBalancerNodePorts:
                    type: boolean
                    default: false
                    title: Enable node port allocation
                    description: See [reference](https://kubernetes.io/docs/concepts/services-networking/service/#load-balancer-nodeport-allocation)
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
          useHostPort:
            type: boolean
        type: object
      defaultBackend:
        additionalProperties: false
        properties:
          affinity:
            $ref: '#/$defs/io.k8s.api.core.v1.Affinity'
          nodeSelector:
            $ref: '#/$defs/kubernetesNodeSelector'
          resources:
            $ref: '#/$defs/kubernetesResourceRequirements'
          tolerations:
            $ref: '#/$defs/kubernetesTolerations'
        type: object
      subDomain:
        type: string
    type: object
  issuers:
    additionalProperties: false
    properties:
      extraIssuers:
        type: array
      letsencrypt:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          prod:
            additionalProperties: false
            properties:
              email:
                type: string
              solvers:
                type: array
            type: object
          staging:
            additionalProperties: false
            properties:
              email:
                type: string
              solvers:
                type: array
            type: object
        type: object
    type: object
  networkPolicies:
    additionalProperties: false
    properties:
      additional:
        type: object
      additionalEgressPolicies:
        type: array
      additionalIngressPolicies:
        type: array
      alertmanager:
        additionalProperties: false
        properties:
          alertReceivers:
            $ref: '#/$defs/netpolRule'
          enabled:
            type: boolean
        type: object
      allowedNameSpaces:
        type: array
      certManager:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          letsencrypt:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
            type: object
          namespaces:
            items:
              default: dex
              type: string
            type: array
          dns01:
            type: object
            properties:
              ips:
                $ref: '#/$defs/iplist'
        type: object
      coredns:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          externalDns:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
            type: object
          serviceIp:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
            type: object
        type: object
      defaultDeny:
        default: false
        type: boolean
      dex:
        additionalProperties: false
        properties:
          connectors:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
              ports:
                $ref: '#/$defs/portlist'
                default:
                  - 443
            type: object
          enabled:
            default: true
            type: boolean
        type: object
      dnsAutoscaler:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
        type: object
      enableAlerting:
        default: true
        type: boolean
      falco:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          plugins:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
              ports:
                $ref: '#/$defs/portlist'
                default:
                  - 443
            type: object
        type: object
      fluentd:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
        type: object
      gatekeeper:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
        type: object
      global:
        additionalProperties: false
        properties:
          externalLoadBalancer:
            type: boolean
          ingressUsingHostNetwork:
            type: boolean
          objectStorage:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
              ports:
                $ref: '#/$defs/portlist'
            required:
              - ips
            type: object
          objectStorageSwift:
            additionalProperties: false
            properties:
              ips:
                items:
                  type: string
                type: array
              ports:
                $ref: '#/$defs/portlist'
                default:
                  - 5000
            required:
              - ips
            type: object
          scApiserver:
            additionalProperties: false
            properties:
              ips:
                items:
                  type: string
                type: array
              port:
                default: 6443
                $ref: '#/$defs/port'
            required:
              - ips
            type: object
          scIngress:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
            required:
              - ips
            type: object
          scNodes:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
            required:
              - ips
            type: object
          trivy:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
              port:
                default: 443
                $ref: '#/$defs/port'
            required:
              - ips
            type: object
          wcIngress:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
            required:
              - ips
            type: object
          wcApiserver:
            properties:
              ips:
                $ref: '#/$defs/iplist'
              port:
                type:
                  - string
                  - integer
          wcNodes:
            properties:
              ips:
                $ref: '#/$defs/iplist'
        required:
          - externalLoadBalancer
          - ingressUsingHostNetwork
        type: object
      harbor:
        additionalProperties: false
        properties:
          database:
            additionalProperties: false
            properties:
              externalEgress:
                additionalProperties: false
                properties:
                  peers:
                    type: array
                  ports:
                    type: array
                type: object
              internalIngress:
                additionalProperties: false
                properties:
                  peers:
                    type: array
                  ports:
                    type: array
                type: object
            type: object
          enabled:
            default: true
            type: boolean
          jobservice:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
              ports:
                $ref: '#/$defs/portlist'
                default:
                  - 443
            type: object
          redis:
            additionalProperties: false
            properties:
              externalEgress:
                additionalProperties: false
                properties:
                  peers:
                    type: array
                  ports:
                    type: array
                type: object
            type: object
          registries:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
              ports:
                $ref: '#/$defs/portlist'
                default:
                  - 443
            type: object
          trivy:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
              ports:
                $ref: '#/$defs/portlist'
                default:
                  - 443
            type: object
        type: object
      ingressNginx:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          ingressOverride:
            additionalProperties: false
            properties:
              enabled:
                default: false
                type: boolean
              ips:
                oneOf:
                  - $ref: '#/$defs/iplist'
                  - type: string
                    const: set-me-if-enabled
            type: object
        type: object
      kubeSystem:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          openstack:
            type: object
            properties:
              enabled:
                type: boolean
              ips:
                $ref: '#/$defs/iplist'
              ports:
                $ref: '#/$defs/portlist'
          upcloud:
            type: object
            properties:
              enabled:
                type: boolean
              ips:
                $ref: '#/$defs/iplist'
              ports:
                $ref: '#/$defs/portlist'
        type: object
      kured:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          notificationSlack:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
              ports:
                $ref: '#/$defs/portlist'
                default:
                  - 443
            type: object
        type: object
      monitoring:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          grafana:
            additionalProperties: false
            properties:
              externalDashboardProvider:
                additionalProperties: false
                properties:
                  ips:
                    $ref: '#/$defs/iplist'
                  ports:
                    $ref: '#/$defs/portlist'
                    default:
                      - 443
                type: object
              externalDataSources:
                additionalProperties: false
                properties:
                  enabled:
                    default: false
                    type: boolean
                  ips:
                    $ref: '#/$defs/iplist'
                  ports:
                    $ref: '#/$defs/portlist'
                type: object
            type: object
        type: object
      opensearch:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
          plugins:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
              ports:
                $ref: '#/$defs/portlist'
                default:
                  - 443
            type: object
        type: object
      rcloneSync:
        additionalProperties: false
        properties:
          destinationObjectStorageS3:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
              ports:
                $ref: '#/$defs/portlist'
                default:
                  - 443
            type: object
          destinationObjectStorageSwift:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
              ports:
                $ref: '#/$defs/portlist'
                default:
                  - 5000
            type: object
          enabled:
            default: true
            type: boolean
          secondaryUrl:
            additionalProperties: false
            properties:
              ips:
                $ref: '#/$defs/iplist'
              ports:
                $ref: '#/$defs/portlist'
                default:
                  - 443
            type: object
        type: object
      rookCeph:
        additionalProperties: false
        properties:
          enabled:
            default: false
            type: boolean
        type: object
      s3Exporter:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
        type: object
      thanos:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
        type: object
      velero:
        additionalProperties: false
        properties:
          enabled:
            default: true
            type: boolean
        type: object
      enabled:
        type: boolean
      enforcement:
        type: string
        $comment: TODO enforcement enum?
      rclone:
        type: object
        properties:
          enabled:
            type: boolean
      externalDns:
        $ref: '#/$defs/netpolRule'
    type: object
  nodeLocalDns:
    additionalProperties: false
    properties:
      customConfig:
        description: https://kubernetes.io/docs/tasks/administer-cluster/dns-custom-nameservers/#coredns-configmap-options
        examples:
          - |-
            example.com:53 {
              errors
              cache 30
              reload
              loop
              forward . 127.0.0.1:9005
            }
        type: string
        default: null
      resources:
        $ref: '#/$defs/kubernetesResourceRequirements'
    type: object
additionalProperties:
  type: object
  properties: {}
